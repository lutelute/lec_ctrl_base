# 第7章 中間試験対策 - 中級編

この中級編では、初級編で学んだ基礎知識を発展させ、実際の計算手法を詳しく学びます。特に部分分数展開の技法、インパルス応答からの伝達関数導出、フィードバック系のステップ応答計算を中心に扱います。

---

## 1. 部分分数展開と逆ラプラス変換 (Partial Fraction Expansion and Inverse Laplace Transform)

### 1.1 部分分数展開の必要性

実際の制御系では、伝達関数は通常、以下のような有理関数の形で表されます：

$$F(s) = \frac{N(s)}{D(s)} = \frac{b_m s^m + b_{m-1}s^{m-1} + \cdots + b_1 s + b_0}{a_n s^n + a_{n-1}s^{n-1} + \cdots + a_1 s + a_0}$$

このままでは変換表を使った逆ラプラス変換が困難なため、**部分分数展開 (Partial Fraction Expansion)** を用いて、より単純な項の和に分解します。

> **前提条件**: $m < n$ であること（真プロパー、Strictly Proper）。もし $m \geq n$ の場合、まず多項式の割り算を行います。

### 1.2 単純極の場合 (Case 1: Distinct Poles)

分母 $D(s)$ が異なる実数の根（単純極）のみを持つ場合です。

**方法**:
分母を因数分解すると、

$$F(s) = \frac{N(s)}{(s-p_1)(s-p_2)\cdots(s-p_n)}$$

これを以下のように部分分数に展開します：

$$F(s) = \frac{A_1}{s-p_1} + \frac{A_2}{s-p_2} + \cdots + \frac{A_n}{s-p_n}$$

**係数 $A_i$ の求め方（留数の計算、Residue Method）**:

$$A_i = \lim_{s \to p_i} (s-p_i)F(s) = \left[(s-p_i)F(s)\right]_{s=p_i}$$

**例1**: $F(s) = \frac{5s+2}{(s+1)(s+3)}$ の逆ラプラス変換を求めよ。

**解**:
部分分数展開の形を仮定：

$$F(s) = \frac{A}{s+1} + \frac{B}{s+3}$$

係数を求める：

$$A = \lim_{s \to -1} (s+1)F(s) = \lim_{s \to -1} \frac{5s+2}{s+3} = \frac{5(-1)+2}{-1+3} = \frac{-3}{2}$$

$$B = \lim_{s \to -3} (s+3)F(s) = \lim_{s \to -3} \frac{5s+2}{s+1} = \frac{5(-3)+2}{-3+1} = \frac{-13}{-2} = \frac{13}{2}$$

したがって、

$$F(s) = \frac{-3/2}{s+1} + \frac{13/2}{s+3}$$

逆ラプラス変換すると、

$$f(t) = -\frac{3}{2}e^{-t} + \frac{13}{2}e^{-3t}, \quad t \geq 0$$

### 1.3 重根の場合 (Case 2: Repeated Poles)

分母に同じ根が複数回現れる場合（重根）の扱いです。

**方法**:
$p_1$ が $r$ 重根の場合、展開形は：

$$F(s) = \frac{A_{11}}{s-p_1} + \frac{A_{12}}{(s-p_1)^2} + \cdots + \frac{A_{1r}}{(s-p_1)^r} + \text{（他の単純極の項）}$$

**係数の求め方**:

$$A_{1r} = \left[(s-p_1)^r F(s)\right]_{s=p_1}$$

$$A_{1(r-1)} = \left[\frac{d}{ds}\left((s-p_1)^r F(s)\right)\right]_{s=p_1}$$

$$A_{1(r-k)} = \frac{1}{k!}\left[\frac{d^k}{ds^k}\left((s-p_1)^r F(s)\right)\right]_{s=p_1}$$

**例2**: $F(s) = \frac{s+3}{(s+1)^2(s+2)}$ の逆ラプラス変換を求めよ。

**解**:
部分分数展開の形：

$$F(s) = \frac{A}{s+1} + \frac{B}{(s+1)^2} + \frac{C}{s+2}$$

係数を求める：

$$B = \left[(s+1)^2 F(s)\right]_{s=-1} = \left[\frac{s+3}{s+2}\right]_{s=-1} = \frac{-1+3}{-1+2} = \frac{2}{1} = 2$$

$$A = \left[\frac{d}{ds}\left((s+1)^2 F(s)\right)\right]_{s=-1} = \left[\frac{d}{ds}\left(\frac{s+3}{s+2}\right)\right]_{s=-1}$$

$$= \left[\frac{(s+2) - (s+3)}{(s+2)^2}\right]_{s=-1} = \frac{-1}{1} = -1$$

$$C = \lim_{s \to -2} (s+2)F(s) = \lim_{s \to -2} \frac{s+3}{(s+1)^2} = \frac{-2+3}{(-2+1)^2} = \frac{1}{1} = 1$$

したがって、

$$F(s) = \frac{-1}{s+1} + \frac{2}{(s+1)^2} + \frac{1}{s+2}$$

逆ラプラス変換すると（$\mathcal{L}^{-1}\{\frac{1}{(s+a)^2}\} = te^{-at}$ を使用）、

$$f(t) = -e^{-t} + 2te^{-t} + e^{-2t} = (-1 + 2t)e^{-t} + e^{-2t}, \quad t \geq 0$$

### 1.4 複素共役極の場合 (Case 3: Complex Conjugate Poles)

分母に複素共役の根が現れる場合です。実係数の伝達関数では、複素根は必ず共役ペアで現れます。

**方法**:
複素共役極 $p = -\alpha \pm j\omega$ を持つ場合、分母因数は：

$$(s-p)(s-\bar{p}) = (s+\alpha-j\omega)(s+\alpha+j\omega) = (s+\alpha)^2 + \omega^2$$

部分分数展開では、この2次因数に対して以下の形を使います：

$$\frac{As+B}{(s+\alpha)^2+\omega^2}$$

**変換表との対応**:

$$\mathcal{L}^{-1}\left\{\frac{s+\alpha}{(s+\alpha)^2+\omega^2}\right\} = e^{-\alpha t}\cos(\omega t)$$

$$\mathcal{L}^{-1}\left\{\frac{\omega}{(s+\alpha)^2+\omega^2}\right\} = e^{-\alpha t}\sin(\omega t)$$

**例3**: $F(s) = \frac{2s+10}{(s+1)(s^2+4s+13)}$ の逆ラプラス変換を求めよ。

**解**:
まず、$s^2+4s+13$ を標準形に変形：

$$s^2+4s+13 = (s+2)^2 + 9 = (s+2)^2 + 3^2$$

部分分数展開の形：

$$F(s) = \frac{A}{s+1} + \frac{Bs+C}{(s+2)^2+9}$$

係数 $A$ を求める：

$$A = \lim_{s \to -1} (s+1)F(s) = \frac{2(-1)+10}{(-1)^2+4(-1)+13} = \frac{8}{10} = \frac{4}{5}$$

残りの項を求めるため、両辺に共通分母をかけて比較：

$$2s+10 = A(s^2+4s+13) + (Bs+C)(s+1)$$

$A = 4/5$ を代入し、適当な $s$ の値で比較するか、係数比較法を使う。

$s=0$ のとき：

$$10 = A \cdot 13 + C \cdot 1 = \frac{4}{5} \cdot 13 + C$$

$$10 = \frac{52}{5} + C \implies C = 10 - \frac{52}{5} = \frac{50-52}{5} = -\frac{2}{5}$$

$s$ の最高次の係数を比較（$s^2$ の係数）：

$$0 = A + B \implies B = -A = -\frac{4}{5}$$

したがって、

$$F(s) = \frac{4/5}{s+1} + \frac{-\frac{4}{5}s - \frac{2}{5}}{(s+2)^2+9}$$

第2項を変形（$s \to s+2$ の形にする）：

$$\frac{-\frac{4}{5}s - \frac{2}{5}}{(s+2)^2+9} = \frac{-\frac{4}{5}(s+2) + \frac{8}{5} - \frac{2}{5}}{(s+2)^2+9} = \frac{-\frac{4}{5}(s+2) + \frac{6}{5}}{(s+2)^2+9}$$

$$= -\frac{4}{5} \cdot \frac{s+2}{(s+2)^2+9} + \frac{6}{5} \cdot \frac{1}{(s+2)^2+9}$$

$$= -\frac{4}{5} \cdot \frac{s+2}{(s+2)^2+9} + \frac{6}{5} \cdot \frac{1}{3} \cdot \frac{3}{(s+2)^2+9}$$

$$= -\frac{4}{5} \cdot \frac{s+2}{(s+2)^2+9} + \frac{2}{5} \cdot \frac{3}{(s+2)^2+9}$$

逆ラプラス変換すると、

$$f(t) = \frac{4}{5}e^{-t} - \frac{4}{5}e^{-2t}\cos(3t) + \frac{2}{5}e^{-2t}\sin(3t), \quad t \geq 0$$

$$= \frac{4}{5}e^{-t} + \frac{2}{5}e^{-2t}(\sin(3t) - 2\cos(3t)), \quad t \geq 0$$

> **ポイント**: 複素共役極の場合、結果は必ず実数の指数減衰振動の形になります。

---

## 2. インパルス応答からの伝達関数導出 (Transfer Function from Impulse Response)

### 2.1 インパルス応答のラプラス変換

伝達関数 $G(s)$ は、インパルス応答 $g(t)$ のラプラス変換として定義されます：

$$G(s) = \mathcal{L}\{g(t)\} = \int_0^{\infty} g(t)e^{-st}dt$$

実際の計算では、既知のラプラス変換表を使用します。

### 2.2 1次系の例

**例1**: インパルス応答が $g(t) = 5e^{-2t}$ のシステムの伝達関数を求め、その性質を調べよ。

**解**:
伝達関数は、

$$G(s) = \mathcal{L}\{5e^{-2t}\} = \frac{5}{s+2}$$

この伝達関数の性質：
- **極**: $s = -2$（1つの実数極）
- **ゼロ**: なし
- **ゲイン**: 定常ゲインは $G(0) = 5/2 = 2.5$
- **時定数**: $\tau = 1/2 = 0.5$ 秒

この系は1次系であり、入力に対して指数関数的に応答します。

### 2.3 2次系の例

**例2**: インパルス応答が $g(t) = 10e^{-t}\sin(3t)$ のシステムの伝達関数を求めよ。

**解**:
変換表から、$\mathcal{L}\{e^{-at}\sin(\omega t)\} = \frac{\omega}{(s+a)^2+\omega^2}$ なので、$a=1$、$\omega=3$ として、

$$G(s) = 10 \cdot \frac{3}{(s+1)^2+9} = \frac{30}{s^2+2s+10}$$

この伝達関数の性質：
- **極**: $s = -1 \pm 3j$（複素共役極）
- **減衰係数**: $\zeta = \frac{1}{\sqrt{10}} \approx 0.316$（減衰振動）
- **固有角周波数**: $\omega_n = \sqrt{10} \approx 3.16$ rad/s
- **減衰振動周波数**: $\omega_d = 3$ rad/s

### 2.4 単位ステップ応答との関係

インパルス応答 $g(t)$ と単位ステップ応答 $h(t)$ の間には、以下の関係があります：

$$g(t) = \frac{dh(t)}{dt}$$

または積分形式で、

$$h(t) = \int_0^t g(\tau)d\tau$$

ラプラス領域では、

$$G(s) = sH(s) \quad \text{または} \quad H(s) = \frac{G(s)}{s}$$

**例3**: 伝達関数 $G(s) = \frac{4}{s+2}$ の系について、インパルス応答とステップ応答を求めよ。

**解**:
インパルス応答：

$$g(t) = \mathcal{L}^{-1}\left\{\frac{4}{s+2}\right\} = 4e^{-2t}$$

ステップ応答のラプラス変換：

$$H(s) = \frac{G(s)}{s} = \frac{4}{s(s+2)}$$

部分分数展開：

$$H(s) = \frac{A}{s} + \frac{B}{s+2}$$

$$A = \left[sH(s)\right]_{s=0} = \frac{4}{2} = 2$$

$$B = \left[(s+2)H(s)\right]_{s=-2} = \frac{4}{-2} = -2$$

$$H(s) = \frac{2}{s} - \frac{2}{s+2}$$

逆ラプラス変換：

$$h(t) = 2 - 2e^{-2t} = 2(1 - e^{-2t})$$

確認：$\frac{dh(t)}{dt} = 2 \cdot 2e^{-2t} = 4e^{-2t} = g(t)$ ✓

---

## 3. フィードバック系の等価変換とステップ応答 (Feedback System Analysis and Step Response)

### 3.1 フィードバック系の等価変換

複雑なブロック線図を簡単化するための等価変換規則です。

**規則1: 直列接続 (Series Connection)**

```
U(s) --> G1(s) --> G2(s) --> Y(s)
```

等価伝達関数：

$$G_{eq}(s) = G_1(s) \cdot G_2(s)$$

**規則2: 並列接続 (Parallel Connection)**

```
        +-> G1(s) --+
U(s) ---|           |-->(+)--> Y(s)
        +-> G2(s) --+
```

等価伝達関数：

$$G_{eq}(s) = G_1(s) + G_2(s)$$

**規則3: 負フィードバック (Negative Feedback)**

```
       +
U(s) ->(+)-> G(s) --> Y(s)
       -^            |
        |            |
        +--- H(s) <--+
```

等価伝達関数：

$$G_{eq}(s) = \frac{G(s)}{1 + G(s)H(s)}$$

### 3.2 閉ループ伝達関数の導出例

**例1**: $G(s) = \frac{10}{s(s+2)}$、$H(s) = 1$ の単位負フィードバック系について、閉ループ伝達関数を求めよ。

**解**:

$$\frac{Y(s)}{R(s)} = \frac{G(s)}{1+G(s)H(s)} = \frac{\frac{10}{s(s+2)}}{1 + \frac{10}{s(s+2)}}$$

$$= \frac{\frac{10}{s(s+2)}}{\frac{s(s+2)+10}{s(s+2)}} = \frac{10}{s^2+2s+10}$$

この閉ループ伝達関数の特性：
- **型**: 0型（分母に $s$ の因数がない）
- **極**: $s = -1 \pm 3j$（複素共役極、安定）
- **減衰係数**: $\zeta = \frac{2}{2\sqrt{10}} = \frac{1}{\sqrt{10}} \approx 0.316$（減衰振動）

### 3.3 ステップ応答の計算

閉ループ系に単位ステップ入力 $R(s) = \frac{1}{s}$ を加えたときの応答を求めます。

**例2**: 上記の閉ループ系（$\frac{Y(s)}{R(s)} = \frac{10}{s^2+2s+10}$）の単位ステップ応答を求めよ。

**解**:
出力のラプラス変換：

$$Y(s) = \frac{10}{s^2+2s+10} \cdot \frac{1}{s} = \frac{10}{s(s^2+2s+10)}$$

部分分数展開：

$$Y(s) = \frac{A}{s} + \frac{Bs+C}{s^2+2s+10}$$

係数 $A$：

$$A = \left[sY(s)\right]_{s=0} = \frac{10}{10} = 1$$

$s^2+2s+10 = (s+1)^2+9$ より、残りの係数を求める。両辺に共通分母をかけて：

$$10 = A(s^2+2s+10) + (Bs+C)s$$

$$10 = 1 \cdot (s^2+2s+10) + (Bs+C)s$$

$$10 = s^2 + 2s + 10 + Bs^2 + Cs$$

係数比較：
- $s^2$ の係数：$0 = 1 + B \implies B = -1$
- $s$ の係数：$0 = 2 + C \implies C = -2$

$$Y(s) = \frac{1}{s} + \frac{-s-2}{s^2+2s+10} = \frac{1}{s} + \frac{-(s+1)-1}{(s+1)^2+9}$$

$$= \frac{1}{s} - \frac{s+1}{(s+1)^2+9} - \frac{1}{3} \cdot \frac{3}{(s+1)^2+9}$$

逆ラプラス変換：

$$y(t) = 1 - e^{-t}\cos(3t) - \frac{1}{3}e^{-t}\sin(3t)$$

$$= 1 - e^{-t}\left(\cos(3t) + \frac{1}{3}\sin(3t)\right), \quad t \geq 0$$

### 3.4 定常偏差の概念

制御系の重要な性能指標の1つが**定常偏差 (Steady-State Error)** です。

単位ステップ入力に対する定常偏差は、

$$e_{ss} = \lim_{t \to \infty} [r(t) - y(t)] = \lim_{s \to 0} s \cdot \frac{1}{1 + G(s)H(s)} \cdot \frac{1}{s}$$

$$= \lim_{s \to 0} \frac{1}{1 + G(s)H(s)}$$

**例3**: $G(s) = \frac{K}{s+5}$、$H(s) = 1$ の系の定常偏差を求めよ。

**解**:

$$e_{ss} = \frac{1}{1 + G(0)H(0)} = \frac{1}{1 + \frac{K}{5}} = \frac{5}{5+K}$$

例えば、$K=5$ のとき、$e_{ss} = 5/10 = 0.5$ となります。

> **ポイント**: 定常偏差をゼロにするには、開ループ伝達関数 $G(s)H(s)$ に積分要素（$1/s$ の因数）が必要です。これを**I型システム（Type 1 System）**と呼びます。

**例4**: $G(s) = \frac{K}{s(s+5)}$、$H(s) = 1$ の系の定常偏差を求めよ。

**解**:
この系は1型システムです。

$$e_{ss} = \lim_{s \to 0} \frac{1}{1 + G(s)H(s)} = \lim_{s \to 0} \frac{1}{1 + \frac{K}{s(s+5)}}$$

分母が $s \to 0$ で無限大になるため、

$$e_{ss} = 0$$

つまり、1型システムは単位ステップ入力に対して定常偏差がゼロになります。

---

## まとめ

この中級編では、中間試験に向けて以下の計算手法を学びました：

### 部分分数展開と逆ラプラス変換
- **単純極の場合**: 留数公式 $A_i = [(s-p_i)F(s)]_{s=p_i}$ を使用
- **重根の場合**: 微分を用いた係数計算が必要
- **複素共役極の場合**: 2次因数の形 $\frac{As+B}{(s+\alpha)^2+\omega^2}$ で扱い、結果は減衰振動

### インパルス応答と伝達関数
- 伝達関数 $G(s)$ はインパルス応答 $g(t)$ のラプラス変換
- ステップ応答との関係：$g(t) = dh(t)/dt$ または $H(s) = G(s)/s$
- 1次系は指数減衰、2次系は減衰振動の応答を示す

### フィードバック系の解析
- 等価変換規則：直列 $G_1 G_2$、並列 $G_1 + G_2$、フィードバック $\frac{G}{1+GH}$
- ステップ応答は部分分数展開を用いて計算
- 定常偏差：0型システムは偏差あり、1型システムは偏差なし

次のステップでは、理解者向け編で留数定理の理論的背景、収束域、安定性解析などを学びます。

---

**作成日**: 2024年
**対象**: 制御工学の中間試験準備
**レベル**: 中級（計算手法と応用）
