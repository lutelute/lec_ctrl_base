# 第4章 伝達関数 - 中級編

## 1. 極と零点の詳細 (Poles and Zeros in Detail)

### 1.1 極と零点の定義

初級編では極について簡単に学びましたが、ここではより詳しく解析します。

一般的な伝達関数は次の形で表されます：

$$G(s) = K\frac{(s-z_1)(s-z_2)\cdots(s-z_m)}{(s-p_1)(s-p_2)\cdots(s-p_n)}$$

ここで：
- **極 (poles)**：$p_1, p_2, \ldots, p_n$ は分母を0にする値
- **零点 (zeros)**：$z_1, z_2, \ldots, z_m$ は分子を0にする値
- $K$：ゲイン（利得）

### 1.2 極と零点の物理的意味

**極の役割**：
- システムの固有振動数を決定
- 安定性を決定（左半平面なら安定、右半平面なら不安定）
- 応答の時定数（減衰率）を決定

**零点の役割**：
- 特定の周波数での応答を打ち消す
- 過渡応答の形状に影響
- 位相特性を変化させる

### 1.3 複素平面上の表現

極と零点は複素平面（s平面）上にプロットできます：

| 記号 | 意味 | 複素平面上の位置 |
|------|------|-----------------|
| × | 極 (pole) | 実軸または複素共役対 |
| ○ | 零点 (zero) | 実軸または複素共役対 |

**安定性の判定**：
- すべての極が**左半平面**（$\text{Re}(s) < 0$）：**安定**
- 極が**虚軸上**（$\text{Re}(s) = 0$）：**臨界安定**
- 極が**右半平面**（$\text{Re}(s) > 0$）：**不安定**

**例**：
```
極: s = -2 ± 3j  → 安定（実部が負）
極: s = 0 ± 2j   → 臨界安定（実部が0）
極: s = 1 ± j    → 不安定（実部が正）
```

### 1.4 極零点の計算例

次の伝達関数の極と零点を求めます：

$$G(s) = \frac{2(s+3)}{s^2 + 5s + 6}$$

**零点**：分子 = 0 より
$$s + 3 = 0 \Rightarrow s = -3$$

**極**：分母 = 0 より
$$s^2 + 5s + 6 = (s+2)(s+3) = 0 \Rightarrow s = -2, -3$$

したがって：
- 零点：$z = -3$
- 極：$p_1 = -2$、$p_2 = -3$

> **注意**: この例では極と零点が同じ位置（$s=-3$）にあり、これらは「極零相殺 (pole-zero cancellation)」します。

---

## 2. 基本要素 (Basic Elements)

制御システムでは、いくつかの標準的な基本要素があります。これらを組み合わせて複雑なシステムを構築します。

### 2.1 比例要素 (Proportional Element)

$$G(s) = K$$

- **特徴**：入力を $K$ 倍するだけ
- **極・零点**：なし
- **応用例**：アンプ、ゲイン調整

**ステップ応答**：
$$y(t) = K \cdot u(t)$$

### 2.2 積分要素 (Integral Element)

$$G(s) = \frac{1}{s} = \frac{K_i}{s}$$

- **特徴**：入力を時間積分
- **極**：$s = 0$（原点に極）
- **零点**：なし
- **応用例**：定常偏差の除去、速度制御

**ステップ応答** ($u(t)=1$)：
$$y(t) = K_i \cdot t$$

> **重要**: 積分要素は定常偏差を0にする効果があります。

### 2.3 微分要素 (Derivative Element)

$$G(s) = s = K_d \cdot s$$

- **特徴**：入力の変化率を出力
- **極**：なし
- **零点**：$s = 0$
- **応用例**：予測制御、ダンピング

**ステップ応答**：
$$y(t) = K_d \cdot \delta(t)$$（インパルス）

> **注意**: 純粋な微分要素は高周波ノイズを増幅するため、実際には不完全微分要素 $G(s) = \frac{Ts}{1+Ts}$ を使用します。

### 2.4 一次遅れ要素 (First-Order Lag)

$$G(s) = \frac{K}{1+Ts}$$

- **特徴**：低域通過フィルタ（LPF）の性質
- **極**：$s = -1/T$
- **零点**：なし
- **時定数**：$T$
- **応用例**：温度センサ、RC回路

**ステップ応答** ($u(t)=1$)：
$$y(t) = K(1 - e^{-t/T})$$

| 時刻 | 応答値 |
|------|--------|
| $t = T$ | $0.632K$ (63.2%) |
| $t = 2T$ | $0.865K$ (86.5%) |
| $t = 3T$ | $0.950K$ (95.0%) |
| $t = 4T$ | $0.982K$ (98.2%) |

### 2.5 一次進み要素 (First-Order Lead)

$$G(s) = 1 + Ts$$

- **特徴**：高周波成分を強調
- **極**：なし
- **零点**：$s = -1/T$
- **応用例**：位相進み補償、応答の高速化

### 2.6 二次遅れ要素 (Second-Order Lag)

$$G(s) = \frac{\omega_n^2}{s^2 + 2\zeta\omega_n s + \omega_n^2}$$

ここで：
- $\omega_n$：**固有角周波数 (natural frequency)**
- $\zeta$：**減衰係数 (damping ratio)**

**極の位置**：
$$s = -\zeta\omega_n \pm \omega_n\sqrt{\zeta^2 - 1}$$

**減衰の分類**：

| 減衰係数 $\zeta$ | 極の特性 | 応答の特徴 |
|-----------------|---------|-----------|
| $\zeta > 1$ | 実数の極2つ | 過減衰 (overdamped) |
| $\zeta = 1$ | 重根 | 臨界減衰 (critically damped) |
| $0 < \zeta < 1$ | 複素共役極 | 不足減衰 (underdamped) |
| $\zeta = 0$ | 虚軸上の極 | 非減衰振動 (undamped) |

**ステップ応答の特性**（$0 < \zeta < 1$ の場合）：

$$y(t) = 1 - \frac{e^{-\zeta\omega_n t}}{\sqrt{1-\zeta^2}} \sin\left(\omega_n\sqrt{1-\zeta^2} \cdot t + \phi\right)$$

ここで $\phi = \cos^{-1}(\zeta)$

**性能指標**：

| 指標 | 式 | 意味 |
|------|---|------|
| オーバーシュート | $M_p = e^{-\pi\zeta/\sqrt{1-\zeta^2}}$ | 最大超過量 |
| 整定時間 | $t_s \approx 4/(\zeta\omega_n)$ | 定常値の±2%に収まる時間 |
| 立ち上がり時間 | $t_r \approx (1.8/\omega_n)$ | 0%から90%に達する時間 |

**例**：
- $\omega_n = 2$ rad/s、$\zeta = 0.5$ のとき
- 極：$s = -1 \pm \sqrt{3}j$
- オーバーシュート：$M_p = e^{-\pi \cdot 0.5/\sqrt{1-0.25}} \approx 0.163$ (16.3%)
- 整定時間：$t_s \approx 4/(0.5 \times 2) = 4$ 秒

---

## 3. ブロック線図の基礎 (Block Diagram Basics)

### 3.1 ブロック線図とは

**ブロック線図 (block diagram)** は、制御システムを視覚的に表現する手法です。各要素を「ブロック」として表し、信号の流れを矢印で示します。

```
U(s) ──→ [G(s)] ──→ Y(s)
```

### 3.2 直列結合 (Series Connection)

複数のシステムを直列に接続した場合：

```
U(s) ──→ [G₁(s)] ──→ [G₂(s)] ──→ Y(s)
```

**合成伝達関数**：
$$G(s) = G_1(s) \cdot G_2(s)$$

**例**：
- $G_1(s) = \frac{2}{s+1}$
- $G_2(s) = \frac{3}{s+2}$

合成伝達関数：
$$G(s) = \frac{2}{s+1} \cdot \frac{3}{s+2} = \frac{6}{(s+1)(s+2)}$$

極：$s = -1, -2$

### 3.3 並列結合 (Parallel Connection)

複数のシステムを並列に接続した場合：

```
        ┌─→ [G₁(s)] ─┐
U(s) ───┤             ├─→ Y(s)
        └─→ [G₂(s)] ─┘
```

**合成伝達関数**：
$$G(s) = G_1(s) + G_2(s)$$

**例**：
- $G_1(s) = \frac{2}{s+1}$
- $G_2(s) = \frac{3}{s+2}$

合成伝達関数：
$$G(s) = \frac{2}{s+1} + \frac{3}{s+2} = \frac{2(s+2) + 3(s+1)}{(s+1)(s+2)} = \frac{5s+7}{(s+1)(s+2)}$$

零点：$s = -7/5 = -1.4$
極：$s = -1, -2$

### 3.4 フィードバック結合 (Feedback Connection)

**負フィードバック系**：

```
        ┌─────────────┐
R(s) ───+──→ [G(s)] ──┴──→ Y(s)
        ↑              |
        |    [H(s)]    |
        └──────────────┘
```

ここで：
- $R(s)$：目標値（参照入力）
- $E(s) = R(s) - H(s)Y(s)$：偏差
- $G(s)$：フォワードパス（順方向）
- $H(s)$：フィードバックパス（帰還）

**合成伝達関数**：
$$G_{cl}(s) = \frac{Y(s)}{R(s)} = \frac{G(s)}{1 + G(s)H(s)}$$

ここで $1 + G(s)H(s)$ を**特性方程式**と呼びます。

**単位フィードバック** ($H(s) = 1$ の場合)：
$$G_{cl}(s) = \frac{G(s)}{1 + G(s)}$$

**例**：
- $G(s) = \frac{K}{s+1}$
- $H(s) = 1$

合成伝達関数：
$$G_{cl}(s) = \frac{K/(s+1)}{1 + K/(s+1)} = \frac{K}{s+1+K}$$

極：$s = -(1+K)$

> **注意**: $K > 0$ なら極は左半平面にあり、システムは安定です。

### 3.5 複雑なブロック線図の簡約化

**例題**：次のブロック線図の合成伝達関数を求めよ。

```
        ┌─→ [G₁] ─→ [G₂] ─┐
R(s) ───┤                  ├─→ Y(s)
        └─→ [G₃] ─────────┘
```

**解法**：

1. 上段（直列結合）：$G_1 \cdot G_2$
2. 並列結合：$G_1 G_2 + G_3$

したがって：
$$G(s) = G_1(s)G_2(s) + G_3(s)$$

---

## 4. 実践的な計算例 (Practical Examples)

### 4.1 例題1：PID制御器の伝達関数

PID制御器（比例・積分・微分）の伝達関数は：

$$G_c(s) = K_p + \frac{K_i}{s} + K_d s = \frac{K_d s^2 + K_p s + K_i}{s}$$

**極**：$s = 0$
**零点**：$K_d s^2 + K_p s + K_i = 0$ の解

$K_p = 10$、$K_i = 5$、$K_d = 2$ のとき：
$$G_c(s) = \frac{2s^2 + 10s + 5}{s}$$

零点：
$$2s^2 + 10s + 5 = 0$$
$$s = \frac{-10 \pm \sqrt{100-40}}{4} = \frac{-10 \pm \sqrt{60}}{4} \approx -0.56, -4.44$$

### 4.2 例題2：フィードバック制御系の設計

プラント（制御対象）が次で与えられるとき：
$$G_p(s) = \frac{1}{s(s+2)}$$

比例ゲイン $K$ の制御器 $G_c(s) = K$ を用いた単位フィードバック系を考えます。

**閉ループ伝達関数**：
$$G_{cl}(s) = \frac{KG_p(s)}{1 + KG_p(s)} = \frac{K/(s(s+2))}{1 + K/(s(s+2))}$$

分母を整理：
$$G_{cl}(s) = \frac{K}{s^2 + 2s + K}$$

**特性方程式**：
$$s^2 + 2s + K = 0$$

**安定性の条件**（ラウス・フルビッツの安定判別法より）：
$$K > 0$$

**極の位置**：
$$s = \frac{-2 \pm \sqrt{4-4K}}{2} = -1 \pm \sqrt{1-K}$$

- $K < 1$：実数極2つ（過減衰）
- $K = 1$：重根（臨界減衰）
- $K > 1$：複素共役極（不足減衰）

### 4.3 例題3：周波数応答

伝達関数 $G(s) = \frac{10}{s+1}$ の周波数応答を求めます。

$s = j\omega$ を代入：
$$G(j\omega) = \frac{10}{j\omega + 1}$$

**ゲイン（振幅）**：
$$|G(j\omega)| = \frac{10}{\sqrt{\omega^2 + 1}}$$

**位相**：
$$\angle G(j\omega) = -\tan^{-1}(\omega)$$

| 周波数 $\omega$ | ゲイン $|G(j\omega)|$ | 位相 (度) |
|----------------|---------------------|----------|
| 0.1 rad/s | 9.95 | -5.7° |
| 1 rad/s | 7.07 | -45° |
| 10 rad/s | 1.00 | -84.3° |

---

## 5. 練習問題 (Practice Problems)

### 問題1
次の伝達関数の極と零点を求めよ：
$$G(s) = \frac{s+4}{s^2 + 3s + 2}$$

<details>
<summary>解答を表示</summary>

零点：$s = -4$

極：$s^2 + 3s + 2 = (s+1)(s+2) = 0$ より $s = -1, -2$
</details>

### 問題2
一次遅れ要素 $G_1(s) = \frac{2}{s+1}$ と $G_2(s) = \frac{3}{s+4}$ を直列接続したときの合成伝達関数を求めよ。

<details>
<summary>解答を表示</summary>

$$G(s) = G_1(s) \cdot G_2(s) = \frac{2}{s+1} \cdot \frac{3}{s+4} = \frac{6}{(s+1)(s+4)}$$

極：$s = -1, -4$
</details>

### 問題3
$G(s) = \frac{K}{s+2}$ と単位フィードバックの閉ループ系で、極が $s=-5$ となる $K$ の値を求めよ。

<details>
<summary>解答を表示</summary>

閉ループ伝達関数：
$$G_{cl}(s) = \frac{K}{s+2+K}$$

極が $s=-5$ のとき：
$$s + 2 + K = 0$$
$$-5 + 2 + K = 0$$
$$K = 3$$
</details>

---

## まとめ

この中級編では、以下を学びました：

- **極と零点の詳細**：複素平面上の位置と安定性の関係、物理的意味
- **基本要素の分類**：
  - 比例要素 ($K$)
  - 積分要素 ($1/s$)
  - 微分要素 ($s$)
  - 一次遅れ要素 ($K/(1+Ts)$)
  - 二次遅れ要素 ($\omega_n^2/(s^2+2\zeta\omega_n s+\omega_n^2)$)
- **ブロック線図の操作**：
  - 直列結合：$G = G_1 \cdot G_2$
  - 並列結合：$G = G_1 + G_2$
  - フィードバック結合：$G = G_1/(1+G_1 G_2)$
- **実践的な設計例**：PID制御器、フィードバック系の安定化

次の**理解者編**では、以下を学習します：
- 伝達関数の等価変換とメイソンの利得公式
- 多入力多出力系（MIMO）への拡張
- 安定性解析の詳細（ナイキスト線図、ボード線図）
- 実際の制御系設計における応用技術

中級編で学んだブロック線図操作と基本要素の知識は、制御系設計の基盤となります。インタラクティブツールを使って、これらの概念を視覚的に確認してみましょう！
