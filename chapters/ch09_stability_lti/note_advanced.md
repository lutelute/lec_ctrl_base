# 第9章 LTIシステムの安定性 - 理解者向け技術ノート

## 1. 内部安定性と外部安定性 (Internal and External Stability)

### 1.1 2つの安定性概念

制御理論では、システムの安定性を2つの異なる視点から考えることができます：

**外部安定性 (External Stability)**：
- 入出力の関係から定義される安定性
- BIBO安定性がこれに該当
- 伝達関数による表現で議論される

**内部安定性 (Internal Stability)**：
- システムの内部状態の挙動から定義される安定性
- 状態空間表現による議論
- すべての状態変数が零入力で平衡点に収束する性質

**重要な関係**：
- 内部安定 ⇒ 外部安定（十分条件）
- 外部安定 ⇏ 内部安定（必要条件ではない）

この不一致は、可制御性・可観測性が失われた場合（極零相殺など）に発生します。

### 1.2 状態空間表現とBIBO安定性

状態空間表現：

$$
\begin{cases}
\dot{\mathbf{x}}(t) = A\mathbf{x}(t) + B\mathbf{u}(t) \\
\mathbf{y}(t) = C\mathbf{x}(t) + D\mathbf{u}(t)
\end{cases}
$$

対応する伝達関数：

$$
G(s) = C(sI - A)^{-1}B + D
$$

**極の由来**：
- 伝達関数の極は $\det(sI - A) = 0$ の解
- これは状態行列 $A$ の固有値に対応

ただし、極零相殺が起こると、伝達関数上では一部の極が消えてしまい、外部からは観測できない不安定モードが隠れる可能性があります。

### 1.3 可制御性・可観測性との関係

**可制御性 (Controllability)**：
- すべての状態を入力によって任意の値に移動できる性質
- 可制御でない場合、入力で影響を与えられない「隠れた状態」が存在

**可観測性 (Observability)**：
- すべての状態を出力から推定できる性質
- 可観測でない場合、出力に現れない「隠れた状態」が存在

**重要な定理**：

システムが **可制御かつ可観測** である場合：
- 伝達関数の極 = 状態行列 $A$ のすべての固有値
- 内部安定性 ⇔ 外部安定性（BIBO安定性）

システムが **可制御でない** または **可観測でない** 場合：
- 伝達関数に現れない極（モード）が存在しうる
- 外部安定でも内部不安定な場合がある

## 2. 状態空間からの安定判別 (Stability Analysis via State-Space)

### 2.1 状態行列の固有値と安定性

状態方程式 $\dot{\mathbf{x}} = A\mathbf{x}$（零入力）の解は：

$$
\mathbf{x}(t) = e^{At}\mathbf{x}(0)
$$

ここで、$e^{At}$ は **行列指数関数 (matrix exponential)** です。

**固有値による表現**：

$A$ の固有値を $\lambda_1, \lambda_2, \ldots, \lambda_n$ とすると、状態の各モードは $e^{\lambda_i t}$ の形で時間発展します。

**内部安定性の必要十分条件**：

システムが漸近安定であるための必要十分条件は、**状態行列 $A$ のすべての固有値が左半平面にある**（実部が負）ことです：

$$
\text{Re}(\lambda_i) < 0 \quad \text{for all } i = 1, 2, \ldots, n
$$

### 2.2 固有値の計算

状態行列 $A$ の固有値は、特性方程式の解として求められます：

$$
\det(\lambda I - A) = 0
$$

**例題1：2次システム**

$$
A = \begin{bmatrix} 0 & 1 \\ -6 & -5 \end{bmatrix}
$$

特性方程式：

$$
\det\begin{bmatrix} \lambda & -1 \\ 6 & \lambda + 5 \end{bmatrix} = \lambda(\lambda + 5) + 6 = \lambda^2 + 5\lambda + 6 = 0
$$

$$
(\lambda + 2)(\lambda + 3) = 0
$$

固有値：$\lambda_1 = -2$、$\lambda_2 = -3$（両方とも左半平面）

**判定：安定**

**例題2：不安定なシステム**

$$
A = \begin{bmatrix} 1 & 2 \\ 0 & -3 \end{bmatrix}
$$

固有値：$\lambda_1 = 1$、$\lambda_2 = -3$

$\lambda_1 = 1 > 0$（右半平面）なので **不安定**

### 2.3 リャプノフの安定性理論（入門）

**リャプノフ安定性 (Lyapunov Stability)** は、より一般的な安定性理論の枠組みです。

#### 2.3.1 リャプノフ関数

**リャプノフ関数 (Lyapunov function)** $V(\mathbf{x})$ は、エネルギー関数のような役割を果たします：

- $V(\mathbf{x}) > 0$ for $\mathbf{x} \neq \mathbf{0}$（正定値）
- $V(\mathbf{0}) = 0$

システムが安定であるためには、時間経過とともに $V$ が減少する必要があります。

#### 2.3.2 リャプノフの安定性定理

平衡点 $\mathbf{x} = \mathbf{0}$ が **漸近安定 (asymptotically stable)** であるための十分条件：

1. $V(\mathbf{x}) > 0$ for $\mathbf{x} \neq \mathbf{0}$（正定値関数）
2. $\dot{V}(\mathbf{x}) < 0$ for $\mathbf{x} \neq \mathbf{0}$（$V$ が時間とともに減少）

ここで：

$$
\dot{V}(\mathbf{x}) = \frac{\partial V}{\partial \mathbf{x}} \cdot \dot{\mathbf{x}} = \frac{\partial V}{\partial \mathbf{x}} \cdot A\mathbf{x}
$$

#### 2.3.3 LTIシステムのリャプノフ方程式

線形システム $\dot{\mathbf{x}} = A\mathbf{x}$ に対して、二次形式のリャプノフ関数を考えます：

$$
V(\mathbf{x}) = \mathbf{x}^T P \mathbf{x}
$$

ここで $P$ は正定値対称行列（$P = P^T > 0$）です。

時間微分：

$$
\dot{V}(\mathbf{x}) = \dot{\mathbf{x}}^T P \mathbf{x} + \mathbf{x}^T P \dot{\mathbf{x}} = \mathbf{x}^T (A^T P + PA) \mathbf{x}
$$

**リャプノフ方程式 (Lyapunov equation)**：

$$
A^T P + PA = -Q
$$

ここで $Q > 0$ は任意の正定値行列（通常 $Q = I$ を選ぶ）です。

**リャプノフの定理（LTIシステム版）**：

システム $\dot{\mathbf{x}} = A\mathbf{x}$ が安定である必要十分条件は、任意の正定値行列 $Q > 0$ に対して、リャプノフ方程式 $A^T P + PA = -Q$ が正定値解 $P > 0$ を持つことです。

**実用上の意義**：
- 固有値を直接計算せずに安定性を判定できる
- 非線形システムへの拡張が可能
- ロバスト安定性解析や最適制御理論の基礎となる

### 2.4 計算例：リャプノフ方程式

**問題**：次のシステムの安定性をリャプノフ方程式で判定せよ。

$$
A = \begin{bmatrix} -1 & 2 \\ 0 & -3 \end{bmatrix}
$$

**解**：

$Q = I$ として、リャプノフ方程式 $A^T P + PA = -I$ を解きます。

$P = \begin{bmatrix} p_{11} & p_{12} \\ p_{12} & p_{22} \end{bmatrix}$ とすると：

$$
\begin{bmatrix} -1 & 0 \\ 2 & -3 \end{bmatrix} \begin{bmatrix} p_{11} & p_{12} \\ p_{12} & p_{22} \end{bmatrix} + \begin{bmatrix} p_{11} & p_{12} \\ p_{12} & p_{22} \end{bmatrix} \begin{bmatrix} -1 & 2 \\ 0 & -3 \end{bmatrix} = \begin{bmatrix} -1 & 0 \\ 0 & -1 \end{bmatrix}
$$

展開して連立方程式を解くと：

$$
P = \begin{bmatrix} 1/2 & 1/6 \\ 1/6 & 1/6 \end{bmatrix}
$$

$P$ が正定値であることを確認（固有値が正、または主小行列式が正）：
- $p_{11} = 1/2 > 0$ ✓
- $\det(P) = (1/2)(1/6) - (1/6)^2 = 1/12 - 1/36 = 2/36 = 1/18 > 0$ ✓

$P > 0$ なので、**システムは安定**

**検証**：固有値は $\lambda_1 = -1$、$\lambda_2 = -3$（両方とも負）→ 確かに安定

## 3. ラウス法の理論的基礎 (Theoretical Foundation of Routh Criterion)

### 3.1 スターム列との関係

ラウス表の第1列は、実は **スターム列 (Sturm sequence)** という数学的構造の一種です。

**スターム列の性質**：

多項式 $p(x)$ に対するスターム列 $\{p_0(x), p_1(x), \ldots, p_k(x)\}$ において、区間 $[a, b]$ での符号変化の差が、その区間内の実根の数を与えます。

ラウスの安定判別法は、この理論を虚軸上での評価に応用したものと見なせます。

### 3.2 特殊ケースの数学的解釈

#### 3.2.1 第1列にゼロが現れる場合

第1列にゼロが現れることは、特性多項式が虚軸上（または虚軸に対称な位置）に根を持つことを示唆します。

$\varepsilon$ 法により、$\varepsilon \to 0^+$ の極限で符号変化を調べることで、虚軸上または虚軸に近い根の存在を検出できます。

#### 3.2.2 ゼロ行が現れる場合

ある行のすべての要素がゼロになるのは、特性多項式が **自己相反多項式 (self-reciprocal polynomial)** の因子を持つ場合です。

これは、虚軸上に対称に配置された根の対（$s = \pm j\omega$）や、原点対称な根の対（$s = \pm \sigma$）が存在することを意味します。

**補助多項式の意味**：

ゼロ行の直前の行から作られる補助多項式は、虚軸上の根を抽出する役割を果たします。この補助多項式を因数分解することで、虚軸上の根を求めることができます。

### 3.3 相対安定性とラウス表

ラウス法は、安定・不安定の判定だけでなく、**相対安定性 (relative stability)** の評価にも利用できます。

**概念**：すべての極が $\text{Re}(s) < -\alpha$（$\alpha > 0$）の領域にあるかを判定したい場合：

1. 変数変換 $s = z - \alpha$ を行う
2. 新しい特性方程式に対してラウス表を作成
3. 安定判定を行う

これにより、「どれくらい安全に安定か」（安定余裕）を評価できます。

## 4. 安定性と極零相殺 (Stability and Pole-Zero Cancellation)

### 4.1 極零相殺の危険性

伝達関数の極と零点が同じ位置にあると、見かけ上は簡約化されます：

$$
G(s) = \frac{(s - z_1)(s - z_2) \cdots}{(s - p_1)(s - p_2) \cdots}
$$

もし $z_i = p_j$ なら、この極零対は約分されます。

**問題点**：

1. **不完全な相殺**：実際の物理システムでは完全な相殺は起こらず、わずかな誤差が残る
2. **隠れた不安定モード**：右半平面の極が零点で相殺されると、伝達関数上は安定に見えても、内部状態は不安定
3. **ロバスト性の欠如**：パラメータ変動で相殺が崩れ、不安定化する可能性

### 4.2 具体例：隠れた不安定モード

**例**：次の状態空間表現を考えます。

$$
\begin{cases}
\dot{\mathbf{x}} = \begin{bmatrix} 2 & 0 \\ 0 & -3 \end{bmatrix} \mathbf{x} + \begin{bmatrix} 1 \\ 1 \end{bmatrix} u \\
y = \begin{bmatrix} -1 & 1 \end{bmatrix} \mathbf{x}
\end{cases}
$$

状態行列 $A$ の固有値：$\lambda_1 = 2$、$\lambda_2 = -3$

**内部安定性**：$\lambda_1 = 2 > 0$ なので **内部不安定**

**伝達関数の計算**：

$$
G(s) = C(sI - A)^{-1}B
$$

$$
(sI - A)^{-1} = \begin{bmatrix} s - 2 & 0 \\ 0 & s + 3 \end{bmatrix}^{-1} = \begin{bmatrix} \frac{1}{s-2} & 0 \\ 0 & \frac{1}{s+3} \end{bmatrix}
$$

$$
G(s) = \begin{bmatrix} -1 & 1 \end{bmatrix} \begin{bmatrix} \frac{1}{s-2} & 0 \\ 0 & \frac{1}{s+3} \end{bmatrix} \begin{bmatrix} 1 \\ 1 \end{bmatrix} = \frac{-1}{s-2} + \frac{1}{s+3}
$$

$$
G(s) = \frac{-(s+3) + (s-2)}{(s-2)(s+3)} = \frac{-5}{(s-2)(s+3)}
$$

あれ？極 $s = 2$ が残っています。もう一度計算します：

$$
G(s) = \frac{-1}{s-2} + \frac{1}{s+3} = \frac{-(s+3) + (s-2)}{(s-2)(s+3)} = \frac{-s-3+s-2}{(s-2)(s+3)} = \frac{-5}{(s-2)(s+3)}
$$

実は相殺されていませんでした。正しく計算すると極 $s = 2$ は伝達関数に現れます。

**別の例（相殺が起こる場合）**：

$$
\begin{cases}
\dot{\mathbf{x}} = \begin{bmatrix} 2 & 0 \\ 0 & -3 \end{bmatrix} \mathbf{x} + \begin{bmatrix} 1 \\ 1 \end{bmatrix} u \\
y = \begin{bmatrix} 1 & 1 \end{bmatrix} \mathbf{x}
\end{bmatrix}
$$

この場合：

$$
G(s) = \frac{1}{s-2} + \frac{1}{s+3} = \frac{(s+3) + (s-2)}{(s-2)(s+3)} = \frac{2s+1}{(s-2)(s+3)}
$$

零点：$s = -1/2$（極との相殺なし）

**正しい相殺例**：

$$
\begin{cases}
\dot{\mathbf{x}} = \begin{bmatrix} 2 & 0 \\ 0 & -3 \end{bmatrix} \mathbf{x} + \begin{bmatrix} 1 \\ 0 \end{bmatrix} u \\
y = \begin{bmatrix} 0 & 1 \end{bmatrix} \mathbf{x}
\end{cases}
$$

この場合：

$$
G(s) = \begin{bmatrix} 0 & 1 \end{bmatrix} \begin{bmatrix} \frac{1}{s-2} & 0 \\ 0 & \frac{1}{s+3} \end{bmatrix} \begin{bmatrix} 1 \\ 0 \end{bmatrix} = 0
$$

あれ？ゼロになりました。これは $B$ と $C$ の構造により、入力から出力への経路が遮断されているためです。

**より適切な例**：

$$
G(s) = \frac{s - 2}{(s - 2)(s + 3)} = \frac{1}{s + 3}
$$

約分により極 $s = 2$ が消えました。しかし、元のシステムに不安定な極 $s = 2$ が存在していた場合、状態空間では $e^{2t}$ の発散項が残ります。

**結論**：
- 伝達関数は $G(s) = \frac{1}{s+3}$（外部安定）
- 内部状態には不安定モード $e^{2t}$ が存在（内部不安定）
- この不安定モードは **可観測でない** または **可制御でない** ため、出力に現れない

### 4.3 内部安定性の重要性

制御系設計では、**内部安定性** を必ず確保する必要があります：

1. **安全性**：隠れた不安定モードは、外乱やパラメータ変動で顕在化する可能性がある
2. **エネルギー消費**：内部的に発散する状態は、アクチュエータの飽和や過負荷を引き起こす
3. **ロバスト性**：モデル化誤差により相殺が崩れると、不安定化する

**設計指針**：
- 状態フィードバック制御では、極配置により内部安定性を直接制御できる
- 出力フィードバック制御では、オブザーバにより状態を推定し、内部安定性を確保
- 極零相殺を利用する制御器設計は慎重に行う

## 5. まとめと次章への橋渡し

### 5.1 本章のまとめ

この理解者向けノートでは、以下の発展的内容を学びました：

1. **内部安定性と外部安定性**
   - BIBO安定性（外部）と状態の漸近安定性（内部）の違い
   - 可制御性・可観測性との関係
   - 内部安定 ⇒ 外部安定、逆は必ずしも成立しない

2. **状態空間からの安定判別**
   - 状態行列 $A$ の固有値がすべて左半平面にあれば内部安定
   - リャプノフ関数とリャプノフ方程式
   - 固有値計算を経由せず安定性を判定できるリャプノフの手法

3. **ラウス法の理論的基礎**
   - スターム列との関係
   - 特殊ケース（ゼロ、ゼロ行）の数学的意味
   - 相対安定性の評価への応用

4. **極零相殺の危険性**
   - 伝達関数上で極が消えても、内部状態には残る
   - 隠れた不安定モードの問題
   - 内部安定性を確保する設計の重要性

5. **リャプノフの安定性理論**
   - エネルギー関数的なアプローチ
   - LTIシステムにおけるリャプノフ方程式
   - 非線形システムへの拡張の基礎

### 5.2 第10章への橋渡し：フィードバックシステムの安定性

本章では、**開ループ系 (open-loop system)** の安定性を学びました。すなわち、システム自体が持つ固有の安定性です。

第10章では、**閉ループ系 (closed-loop system)**、つまりフィードバック制御系の安定性を学びます：

**第10章の主要トピック**：

1. **フィードバックと安定性**
   - 負フィードバックは安定化に寄与することが多い
   - しかし、不適切なフィードバックは安定なシステムを不安定化させる

2. **ナイキスト安定判別法 (Nyquist Stability Criterion)**
   - 周波数応答（ナイキスト線図）から閉ループ安定性を判定
   - 開ループの極の情報と周波数応答の包囲回数から判定

3. **安定余裕 (Stability Margins)**
   - **ゲイン余裕 (Gain Margin)**：ゲインをどれだけ増やせるか
   - **位相余裕 (Phase Margin)**：位相をどれだけ遅らせられるか
   - ロバスト安定性の指標

4. **ボード線図による安定余裕の読み取り**
   - ゲイン交差周波数と位相交差周波数
   - 実用的な設計指針（位相余裕 30°～60°など）

**連続性**：
- 第9章で学んだ「極の位置」が、第10章では「周波数応答の形状」として現れます
- ラウス法は閉ループ特性方程式にも適用できますが、ナイキスト法は開ループデータから閉ループ安定性を予測できる点で強力
- リャプノフ理論は、第10章以降の適応制御やロバスト制御の理論的基盤となります

**期待される学習成果**：

第9章で「システムが安定かどうか」を判定できるようになりました。第10章では「どうやって安定化させるか」「どれくらい安定か」を学び、実用的な制御系設計の能力を身につけます。

---

## 参考文献と発展的学習

**リャプノフ安定性のさらなる学習**：
- Khalil, H. K., "Nonlinear Systems" - 非線形システムへの拡張
- Slotine, J.-J. E., and Li, W., "Applied Nonlinear Control" - 実用的な応用例

**状態空間法の深化**：
- Kailath, T., "Linear Systems" - 線形システム理論の包括的教科書
- Zhou, K., et al., "Robust and Optimal Control" - 現代制御理論

**ラウス法とスターム列**：
- Gantmacher, F. R., "The Theory of Matrices" - 行列理論と安定性

---

**キーワード**：
- 内部安定性 (Internal Stability)
- 外部安定性 (External Stability)
- 可制御性 (Controllability)
- 可観測性 (Observability)
- 固有値 (Eigenvalues)
- リャプノフ安定性 (Lyapunov Stability)
- リャプノフ関数 (Lyapunov Function)
- リャプノフ方程式 (Lyapunov Equation)
- 行列指数関数 (Matrix Exponential)
- スターム列 (Sturm Sequence)
- 極零相殺 (Pole-Zero Cancellation)
- 隠れたモード (Hidden Mode)
- 相対安定性 (Relative Stability)
- 安定余裕 (Stability Margin)
