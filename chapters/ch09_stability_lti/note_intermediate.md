# 第9章 LTIシステムの安定性 - 中級編

## 1. BIBO安定性の数学的定義

### 1.1 インパルス応答と絶対可積分性

初級編では、BIBO安定性を「有界な入力に対して出力が有界」という直感的な定義で学びました。中級編では、より厳密な数学的定義を見ていきます。

**BIBO安定性の厳密な定義**：

LTIシステムがBIBO安定であるための必要十分条件は、システムの **インパルス応答 (impulse response)** $h(t)$ が **絶対可積分 (absolutely integrable)** であることです：

$$
\int_{0}^{\infty} |h(t)| \, dt < \infty
$$

この条件が満たされるとき、任意の有界入力 $u(t)$ に対して、出力 $y(t)$ も有界になります。

### 1.2 なぜ絶対可積分性が条件なのか？

LTIシステムの入出力関係は **畳み込み積分 (convolution integral)** で表されます：

$$
y(t) = \int_{0}^{\infty} h(\tau) u(t - \tau) \, d\tau
$$

入力が有界（$|u(t)| \leq M_u$）のとき、出力の大きさは：

$$
|y(t)| \leq \int_{0}^{\infty} |h(\tau)| \cdot |u(t - \tau)| \, d\tau \leq M_u \int_{0}^{\infty} |h(\tau)| \, d\tau
$$

したがって、$\int_{0}^{\infty} |h(t)| \, dt < \infty$ であれば、$|y(t)|$ も有界になることが保証されます。

### 1.3 伝達関数との関係

伝達関数 $G(s)$ とインパルス応答 $h(t)$ は、ラプラス変換で結ばれています：

$$
G(s) = \mathcal{L}\{h(t)\} = \int_{0}^{\infty} h(t) e^{-st} \, dt
$$

**重要な結果**：

伝達関数 $G(s)$ の **すべての極が左半平面にある**（実部が負）とき、インパルス応答 $h(t)$ は絶対可積分になり、システムはBIBO安定です。

**理由**：

極が $s = -\alpha$（$\alpha > 0$）のとき、対応する時間応答は $e^{-\alpha t}$ となり、これは $t \to \infty$ で指数関数的に減衰します：

$$
\int_{0}^{\infty} |e^{-\alpha t}| \, dt = \int_{0}^{\infty} e^{-\alpha t} \, dt = \frac{1}{\alpha} < \infty
$$

## 2. 伝達関数による安定判別

### 2.1 安定判別の基本規則

伝達関数 $G(s)$ が与えられたとき、安定性を判定する規則：

**規則1：安定**
- すべての極が左半平面（$\text{Re}(s) < 0$）にある
- システムは漸近安定 (asymptotically stable)

**規則2：不安定**
- 1つでも極が右半平面（$\text{Re}(s) > 0$）にある
- または、虚軸上に重根がある

**規則3：臨界安定**
- 虚軸上に単純根（重複度1）の極があり、他の極はすべて左半平面にある
- 厳密にはBIBO安定ではない

### 2.2 1次系の安定性

1次系の伝達関数：

$$
G(s) = \frac{K}{s + a}
$$

- **極**：$s = -a$
- **安定条件**：$a > 0$（極が左半平面）

**例1：安定な1次系**

$$
G(s) = \frac{5}{s + 3}
$$

- 極：$s = -3$（左半平面）
- ステップ応答：$y(t) = \frac{5}{3}(1 - e^{-3t})$
- $t \to \infty$ で $y(t) \to \frac{5}{3}$（収束）
- **判定：安定**

**例2：不安定な1次系**

$$
G(s) = \frac{2}{s - 1}
$$

- 極：$s = 1$（右半平面）
- ステップ応答：$y(t) = 2e^{t}$
- $t \to \infty$ で $y(t) \to \infty$（発散）
- **判定：不安定**

### 2.3 2次系の安定性

2次系の標準形：

$$
G(s) = \frac{\omega_n^2}{s^2 + 2\zeta\omega_n s + \omega_n^2}
$$

ここで、$\zeta$ は **減衰係数 (damping ratio)**、$\omega_n$ は **固有角周波数 (natural frequency)** です。

**極の計算**：

特性方程式 $s^2 + 2\zeta\omega_n s + \omega_n^2 = 0$ を解くと：

$$
s_{1,2} = -\zeta\omega_n \pm \omega_n\sqrt{\zeta^2 - 1}
$$

**安定条件**：

すべての係数が正（$\zeta > 0$、$\omega_n > 0$）であれば、極の実部は負となり安定です。

**ケース分類**：

1. **過制動 (overdamped)**：$\zeta > 1$
   - 2つの異なる実数極（両方とも左半平面）
   - 指数関数的に収束

2. **臨界制動 (critically damped)**：$\zeta = 1$
   - 重複実数極 $s = -\omega_n$
   - 最も速く収束（オーバーシュートなし）

3. **不足制動 (underdamped)**：$0 < \zeta < 1$
   - 共役複素数極：$s = -\zeta\omega_n \pm j\omega_n\sqrt{1-\zeta^2}$
   - 減衰振動

4. **非制動 (undamped)**：$\zeta = 0$
   - 純虚数極：$s = \pm j\omega_n$（虚軸上）
   - 減衰しない振動（臨界安定）

5. **負の減衰**：$\zeta < 0$
   - 極が右半平面
   - 発散（不安定）

**例：不足制動の2次系**

$$
G(s) = \frac{25}{s^2 + 4s + 25}
$$

- $\omega_n^2 = 25$ より $\omega_n = 5$
- $2\zeta\omega_n = 4$ より $\zeta = 0.4$
- 極：$s = -2 \pm j\sqrt{21}$（左半平面の共役複素数）
- **判定：安定**（減衰振動）

## 3. ラウスの安定判別法

### 3.1 ラウス法の目的

システムの特性方程式が高次（3次以上）の場合、極を直接計算するのは困難です。

**ラウスの安定判別法 (Routh's stability criterion)** は、特性方程式の係数から **ラウス表 (Routh array)** を作成し、極を計算せずに安定性を判定する方法です。

### 3.2 特性方程式

伝達関数の分母を $D(s)$ とすると、特性方程式は：

$$
D(s) = a_n s^n + a_{n-1} s^{n-1} + \cdots + a_1 s + a_0 = 0
$$

通常、最高次の係数を1に正規化します：

$$
s^n + a_{n-1} s^{n-1} + \cdots + a_1 s + a_0 = 0
$$

### 3.3 ラウス表の構成手順

**ステップ1：初期行の設定**

特性方程式の係数を交互に並べて、最初の2行を作ります：

| 行 | 第1列 | 第2列 | 第3列 | ... |
|---|-------|-------|-------|-----|
| $s^n$ | $a_n$ | $a_{n-2}$ | $a_{n-4}$ | ... |
| $s^{n-1}$ | $a_{n-1}$ | $a_{n-3}$ | $a_{n-5}$ | ... |

**ステップ2：次の行の計算**

第3行以降は、以下の公式で計算します：

$$
b_k = -\frac{1}{a_{n-1}} \begin{vmatrix} a_n & a_{n-2k} \\ a_{n-1} & a_{n-1-2k} \end{vmatrix} = \frac{a_{n-1} \cdot a_{n-2k} - a_n \cdot a_{n-1-2k}}{a_{n-1}}
$$

より具体的には：

$$
b_1 = \frac{a_{n-1} \cdot a_{n-2} - a_n \cdot a_{n-3}}{a_{n-1}}
$$

$$
b_2 = \frac{a_{n-1} \cdot a_{n-4} - a_n \cdot a_{n-5}}{a_{n-1}}
$$

この計算を繰り返し、$s^0$ の行まで作成します。

### 3.4 安定判別の規則

**ラウスの安定判別規則**：

システムが安定であるための必要十分条件は、**ラウス表の第1列の要素がすべて正** であることです。

**符号変化の数**：

第1列で符号が変化する回数が、**右半平面にある極の数** に等しくなります。

- 符号変化なし → 安定（すべての極が左半平面）
- 符号変化あり → 不安定（右半平面に極がある）

### 3.5 具体例：3次系

特性方程式：

$$
D(s) = s^3 + 6s^2 + 11s + 6 = 0
$$

**ラウス表の作成**：

| 行 | 第1列 | 第2列 |
|---|-------|-------|
| $s^3$ | 1 | 11 |
| $s^2$ | 6 | 6 |
| $s^1$ | $b_1$ | 0 |
| $s^0$ | $c_1$ | |

**$s^1$ 行の計算**：

$$
b_1 = \frac{6 \cdot 11 - 1 \cdot 6}{6} = \frac{66 - 6}{6} = \frac{60}{6} = 10
$$

**$s^0$ 行の計算**：

$$
c_1 = \frac{10 \cdot 6 - 6 \cdot 0}{10} = \frac{60}{10} = 6
$$

**完成したラウス表**：

| 行 | 第1列 | 第2列 |
|---|-------|-------|
| $s^3$ | 1 | 11 |
| $s^2$ | 6 | 6 |
| $s^1$ | 10 | 0 |
| $s^0$ | 6 | |

**安定判定**：

第1列：1, 6, 10, 6 → すべて正

符号変化なし → **安定**

**検証**：

特性方程式を因数分解すると：

$$
s^3 + 6s^2 + 11s + 6 = (s+1)(s+2)(s+3) = 0
$$

極：$s = -1, -2, -3$（すべて左半平面）→ 確かに安定

### 3.6 具体例：不安定なシステム

特性方程式：

$$
D(s) = s^3 + 2s^2 - 5s + 6 = 0
$$

**ラウス表**：

| 行 | 第1列 | 第2列 |
|---|-------|-------|
| $s^3$ | 1 | -5 |
| $s^2$ | 2 | 6 |
| $s^1$ | $b_1$ | 0 |
| $s^0$ | $c_1$ | |

**計算**：

$$
b_1 = \frac{2 \cdot (-5) - 1 \cdot 6}{2} = \frac{-10 - 6}{2} = \frac{-16}{2} = -8
$$

$$
c_1 = \frac{(-8) \cdot 6 - 2 \cdot 0}{-8} = \frac{-48}{-8} = 6
$$

**完成したラウス表**：

| 行 | 第1列 | 第2列 |
|---|-------|-------|
| $s^3$ | 1 | -5 |
| $s^2$ | 2 | 6 |
| $s^1$ | -8 | 0 |
| $s^0$ | 6 | |

**安定判定**：

第1列：1, 2, -8, 6 → 符号変化が2回（1→2→-8で1回、-8→6で1回）

符号変化2回 → **右半平面に2つの極** → **不安定**

## 4. 特殊ケースの取り扱い

### 4.1 第1列にゼロが現れる場合

ラウス表の第1列にゼロが現れると、次の行の計算で割り算ができなくなります。

**対処法：ε法**

ゼロの代わりに、非常に小さい正の数 $\varepsilon > 0$ を置いて計算を続け、最後に $\varepsilon \to 0^+$ の極限をとります。

**例**：

特性方程式：

$$
D(s) = s^3 + 2s^2 + s + 2 = 0
$$

**ラウス表**：

| 行 | 第1列 | 第2列 |
|---|-------|-------|
| $s^3$ | 1 | 1 |
| $s^2$ | 2 | 2 |
| $s^1$ | $b_1$ | 0 |

**計算**：

$$
b_1 = \frac{2 \cdot 1 - 1 \cdot 2}{2} = \frac{2 - 2}{2} = 0
$$

ゼロが現れたので、$b_1 = \varepsilon$ と置きます：

| 行 | 第1列 | 第2列 |
|---|-------|-------|
| $s^3$ | 1 | 1 |
| $s^2$ | 2 | 2 |
| $s^1$ | $\varepsilon$ | 0 |
| $s^0$ | $c_1$ | |

$$
c_1 = \frac{\varepsilon \cdot 2 - 2 \cdot 0}{\varepsilon} = 2
$$

**$\varepsilon \to 0^+$ の極限**：

第1列：1, 2, $\varepsilon \to 0^+$, 2

符号変化：2 → $\varepsilon$ → 2 で1回（$\varepsilon \to 0^+$ なので、正から負への変化はないが、極限では2→0→2となり虚軸上に極がある）

**結論**：このシステムは虚軸上に極を持ち、**臨界安定**または**不安定**です。

### 4.2 ゼロ行（全要素がゼロ）が現れる場合

ある行のすべての要素がゼロになることがあります。これは、虚軸上に対称に極が配置されている（例：$s = \pm j\omega$）ことを示します。

**対処法：補助多項式**

ゼロ行の直前の行の係数から **補助多項式 (auxiliary polynomial)** を作り、それを $s$ で微分した係数で次の行を置き換えます。

**例**：

特性方程式：

$$
D(s) = s^4 + 2s^3 + 3s^2 + 2s + 2 = 0
$$

ラウス表を作成していくと、$s^1$ 行がゼロ行になることがあります。

その場合、$s^2$ 行から補助多項式を作ります：

$$
P(s) = a \cdot s^2 + b
$$

これを $s$ で微分：

$$
\frac{dP}{ds} = 2as
$$

この係数を使って $s^1$ 行を埋めます。

### 4.3 すべての係数が正でない場合

**必要条件**：

システムが安定であるためには、特性方程式のすべての係数が正でなければなりません（最高次の係数で正規化した後）。

もし1つでも負の係数があるか、係数が欠けている（ゼロ）場合、システムは必ず不安定です。

**例**：

$$
D(s) = s^3 + 2s^2 - 5s + 1 = 0
$$

$s$ の係数が負（-5）なので、ラウス表を作るまでもなく **不安定** と判定できます。

## 5. ラウス法の利点と限界

### 5.1 利点

1. **計算効率**：高次の多項式の根を求めずに安定性を判定できる
2. **代数的手法**：数値計算の誤差が少ない
3. **パラメータ設計**：システムパラメータの安定範囲を求めるのに有用

### 5.2 限界

1. **安定度の情報なし**：極がどれくらい左半平面にあるか（安定余裕）は分からない
2. **極の位置**：極の正確な位置や配置は得られない
3. **LTIシステムのみ**：線形時不変システムにのみ適用可能

## 6. まとめ

この中級編では、以下を学びました：

1. **BIBO安定性の数学的定義**
   - インパルス応答の絶対可積分性：$\int_{0}^{\infty} |h(t)| \, dt < \infty$
   - 伝達関数の極がすべて左半平面にあることと等価

2. **伝達関数による安定判別**
   - 1次系：$a > 0$ で安定
   - 2次系：$\zeta > 0$、$\omega_n > 0$ で安定
   - 減衰係数 $\zeta$ が応答特性を決定

3. **ラウスの安定判別法**
   - 特性方程式の係数からラウス表を作成
   - 第1列の符号変化の回数 = 右半平面の極の数
   - 符号変化なし → 安定

4. **特殊ケースの対処**
   - 第1列のゼロ：$\varepsilon$ 法
   - ゼロ行：補助多項式を利用
   - 係数に負がある：必ず不安定

5. **ラウス法の実用性**
   - 高次システムの安定性を代数的に判定
   - 設計パラメータの安定範囲を決定

> **次のステップ**: 理解者向け編では、状態空間表現からの安定判別、リャプノフの安定性理論、極零相殺と内部安定性の問題を学びます。

---

**キーワード**：
- インパルス応答 (Impulse Response)
- 絶対可積分 (Absolutely Integrable)
- 減衰係数 (Damping Ratio)
- ラウスの安定判別法 (Routh's Stability Criterion)
- ラウス表 (Routh Array)
- 特性方程式 (Characteristic Equation)
- 補助多項式 (Auxiliary Polynomial)
