# 第11章 制御系の過渡特性 - 理解者向け技術ノート

## 1. 2次系の一般解 (General Solution of Second-Order Systems)

### 1.1 2次系の微分方程式

2次系の標準形の伝達関数：

$$G(s) = \frac{\omega_n^2}{s^2 + 2\zeta\omega_n s + \omega_n^2}$$

単位ステップ入力 $u(t) = 1$ に対する応答を求めるため、対応する微分方程式を考えます：

$$\ddot{y}(t) + 2\zeta\omega_n \dot{y}(t) + \omega_n^2 y(t) = \omega_n^2 u(t)$$

### 1.2 特性方程式と極の導出

**特性方程式 (characteristic equation)** は：

$$s^2 + 2\zeta\omega_n s + \omega_n^2 = 0$$

解の公式により：

$$s_{1,2} = \frac{-2\zeta\omega_n \pm \sqrt{4\zeta^2\omega_n^2 - 4\omega_n^2}}{2}$$

$$s_{1,2} = -\zeta\omega_n \pm \omega_n\sqrt{\zeta^2 - 1}$$

減衰比 $\zeta$ の値によって、極の形式が変わります。

### 1.3 不足減衰系の一般解 ($0 < \zeta < 1$)

$\zeta < 1$ の場合、極は複素共役対となります：

$$s_{1,2} = -\zeta\omega_n \pm j\omega_n\sqrt{1-\zeta^2} = -\zeta\omega_n \pm j\omega_d$$

ここで、$\omega_d = \omega_n\sqrt{1-\zeta^2}$ は**減衰振動数 (damped natural frequency)** です。

単位ステップ応答の一般解は：

$$y(t) = 1 - \frac{e^{-\zeta\omega_n t}}{\sqrt{1-\zeta^2}} \sin(\omega_d t + \phi)$$

ここで、位相角 $\phi$ は以下で与えられます：

$$\phi = \cos^{-1}(\zeta) = \tan^{-1}\left(\frac{\sqrt{1-\zeta^2}}{\zeta}\right)$$

**別の表現形式**:

$$y(t) = 1 - e^{-\zeta\omega_n t}\left[\cos(\omega_d t) + \frac{\zeta}{\sqrt{1-\zeta^2}}\sin(\omega_d t)\right]$$

### 1.4 臨界減衰系 ($\zeta = 1$)

$\zeta = 1$ の場合、極は実軸上で重根となります：

$$s_{1,2} = -\omega_n$$

単位ステップ応答：

$$y(t) = 1 - e^{-\omega_n t}(1 + \omega_n t)$$

**特徴**:
- オーバーシュートなし
- 振動せずに最速で収束
- 多くの制御系で目標とされる応答

### 1.5 過減衰系 ($\zeta > 1$)

$\zeta > 1$ の場合、極は2つの異なる実数値となります：

$$s_1 = -\zeta\omega_n + \omega_n\sqrt{\zeta^2-1}$$
$$s_2 = -\zeta\omega_n - \omega_n\sqrt{\zeta^2-1}$$

単位ステップ応答：

$$y(t) = 1 - \frac{s_2 e^{s_1 t} - s_1 e^{s_2 t}}{s_2 - s_1}$$

**特徴**:
- オーバーシュートなし
- 臨界減衰よりも遅い応答
- 1次遅れ系の組み合わせと見なせる

## 2. 特性値の数学的導出 (Mathematical Derivation of Characteristic Values)

### 2.1 ピーク時間 $T_p$ の導出

ステップ応答が最初のピークに達する時刻は、$\frac{dy(t)}{dt} = 0$ を満たす最小の正の時刻です。

$$\frac{dy(t)}{dt} = \omega_n e^{-\zeta\omega_n t} \sin(\omega_d t) = 0$$

$e^{-\zeta\omega_n t} \neq 0$ より：

$$\sin(\omega_d t) = 0$$

最小の正の解は：

$$\omega_d T_p = \pi$$

したがって：

$$T_p = \frac{\pi}{\omega_d} = \frac{\pi}{\omega_n\sqrt{1-\zeta^2}}$$

### 2.2 最大オーバーシュート $M_p$ の導出

$t = T_p$ におけるステップ応答の値を計算します：

$$y(T_p) = 1 - \frac{e^{-\zeta\omega_n T_p}}{\sqrt{1-\zeta^2}} \sin(\omega_d T_p + \phi)$$

$\omega_d T_p = \pi$ より、$\sin(\pi + \phi) = -\sin(\phi) = -\sqrt{1-\zeta^2}$ を用いると：

$$y(T_p) = 1 + e^{-\zeta\omega_n \cdot \frac{\pi}{\omega_d}}$$

$$y(T_p) = 1 + e^{-\frac{\zeta\pi}{\sqrt{1-\zeta^2}}}$$

最大オーバーシュート（百分率）は：

$$M_p = \left(y(T_p) - 1\right) \times 100\% = e^{-\frac{\zeta\pi}{\sqrt{1-\zeta^2}}} \times 100\%$$

**重要な関係**:
- $\zeta \to 0$ のとき $M_p \to 100\%$（非減衰振動）
- $\zeta \to 1$ のとき $M_p \to 0$（臨界減衰）

### 2.3 整定時間 $T_s$ の導出

2%整定時間は、応答が最終値の±2%以内に収まる時間です。

応答の包絡線（エンベロープ）は：

$$e^{-\zeta\omega_n t}$$

誤差が2%以内になる条件は：

$$e^{-\zeta\omega_n T_s} \leq 0.02$$

両辺の自然対数をとると：

$$-\zeta\omega_n T_s \leq \ln(0.02) = -3.912$$

したがって：

$$T_s \geq \frac{3.912}{\zeta\omega_n} \approx \frac{4}{\zeta\omega_n}$$

**5%基準の場合**:

$$T_s \approx \frac{3}{\zeta\omega_n}$$

### 2.4 立ち上がり時間 $T_r$ の近似

立ち上がり時間（10%→90%）の厳密解は複雑なため、通常は近似式を使用します：

$$T_r \approx \frac{1.8}{\omega_n}$$

より正確な式は：

$$T_r = \frac{\pi - \beta}{\omega_d}$$

ここで、$\beta = \tan^{-1}\left(\frac{\sqrt{1-\zeta^2}}{\zeta}\right)$ です。

**数値例**: $\zeta = 0.5$ の場合：
- $\beta = \tan^{-1}(\sqrt{3}) = 60° = 1.047$ [rad]
- $T_r = \frac{\pi - 1.047}{\omega_d} = \frac{2.094}{\omega_d}$

## 3. 極配置と応答速度の関係 (Relationship Between Pole Placement and Response Speed)

### 3.1 s平面上の極の位置表現

不足減衰系の極は、複素平面上で以下のように表現できます：

$$s_{1,2} = -\zeta\omega_n \pm j\omega_d$$

極座標表現では：
- 極から原点までの距離：$r = |s| = \omega_n$
- 極と負の実軸のなす角度：$\theta = \cos^{-1}(\zeta)$

```
        虚軸 (Im)
          ↑
          |      × s₁
          |     /|
          |    / | ωd
          |   /  |
          |  / θ |
          | /    |
----+-----+------+----→ 実軸 (Re)
    |     |      -ζωn
    |      \ θ  |
    |       \   |
    |        \  |
    |         \ | ωd
    |          \|
    |           × s₂
```

### 3.2 極の実部と減衰特性

極の実部 $\sigma = -\zeta\omega_n$ は、**減衰率 (decay rate)** を決定します。

指数関数的な減衰：

$$e^{\sigma t} = e^{-\zeta\omega_n t}$$

**設計指針**:
- 極の実部が大きく負 → 速い減衰
- 整定時間 $T_s \approx \frac{4}{|\sigma|} = \frac{4}{\zeta\omega_n}$

### 3.3 極の虚部と振動特性

極の虚部 $\omega_d = \omega_n\sqrt{1-\zeta^2}$ は、**振動周波数 (oscillation frequency)** を決定します。

振動周期：

$$T_{osc} = \frac{2\pi}{\omega_d}$$

ピーク時間との関係：

$$T_p = \frac{\pi}{\omega_d} = \frac{T_{osc}}{2}$$

つまり、ピーク時間は振動周期の半分です。

### 3.4 等減衰比線と等固有振動数線

**等減衰比線 (constant damping ratio lines)**:

$$\zeta = \text{const.} \Rightarrow \theta = \cos^{-1}(\zeta) = \text{const.}$$

これは原点を通る放射線です。

**等固有振動数線 (constant natural frequency lines)**:

$$\omega_n = \text{const.} \Rightarrow |s| = \text{const.}$$

これは原点を中心とする円です。

**設計への応用**:
- 所望のオーバーシュート → 減衰比 → 許容角度範囲
- 所望の整定時間 → 極の実部の最小値
- これらの制約から極の配置領域が決定される

### 3.5 支配的極の概念 (Dominant Poles)

高次システムでは、すべての極が応答に同程度に寄与するわけではありません。

**支配的極 (dominant poles)** とは：
- 原点に最も近い極（実部の絶対値が小さい）
- システムの過渡応答を主に決定する極

**条件**:
他の極が支配的極の実部の5倍以上左側にある場合、2次系で近似できます：

$$|\text{Re}(s_{others})| \geq 5|\text{Re}(s_{dominant})|$$

## 4. 根軌跡法の基礎 (Fundamentals of Root Locus Method)

### 4.1 根軌跡の概念

**根軌跡 (root locus)** は、システムのパラメータ（通常はゲイン $K$）を変化させたときに、閉ループ系の極がs平面上で描く軌跡です。

**基本的なフィードバック系**:

```
       +     E(s)        Y(s)
R(s) →(Σ)→ K·G(s) → Y(s)
       -↑________________|
```

閉ループ伝達関数：

$$T(s) = \frac{KG(s)}{1 + KG(s)}$$

閉ループ系の極は、特性方程式 $1 + KG(s) = 0$ の解です。

### 4.2 根軌跡の基本ルール

伝達関数 $G(s) = \frac{N(s)}{D(s)}$ に対する根軌跡の基本的な性質：

**ルール1**: 根軌跡の開始点と終点
- $K = 0$ のとき、極は開ループ系の極（$D(s) = 0$ の解）
- $K \to \infty$ のとき、極は開ループ系の零点（$N(s) = 0$ の解）または無限遠点

**ルール2**: 根軌跡の分岐数
- 根軌跡の分岐数 = $\max(\text{極の数}, \text{零点の数})$

**ルール3**: 実軸上の根軌跡
- 実軸上のある点 $s = \sigma$ において、その点から右側にある極と零点の総数が奇数ならば、その点は根軌跡上にある

**ルール4**: 漸近線
- 極の数 $n$、零点の数 $m$ として、$n - m$ 本の漸近線が無限遠点に向かう
- 漸近線の角度：$\phi_k = \frac{(2k+1)\pi}{n-m}$、$k = 0, 1, 2, \ldots, n-m-1$
- 漸近線の交点（重心）：$\sigma_a = \frac{\sum \text{極} - \sum \text{零点}}{n - m}$

### 4.3 ゲイン変化と極の移動

**例題**: 以下のシステムの根軌跡を考えます：

$$G(s) = \frac{1}{s(s+2)}$$

特性方程式：

$$1 + \frac{K}{s(s+2)} = 0$$

$$s^2 + 2s + K = 0$$

極の位置：

$$s_{1,2} = -1 \pm \sqrt{1 - K}$$

**$K$ の変化に伴う極の移動**:

| $K$ の範囲 | 極の位置 | システム特性 |
|----------|---------|-----------|
| $0 < K < 1$ | 2つの実数極 | 過減衰 |
| $K = 1$ | $s = -1$ (重根) | 臨界減衰 |
| $K > 1$ | 複素共役極 | 不足減衰 |
| $K = 4$ | $s = -1 \pm j\sqrt{3}$ | $\zeta = 0.5$ |
| $K \to \infty$ | 虚軸に近づく | 非減衰に近づく |

**観察**:
- $K$ を増加させると、極は実軸から複素平面に移動
- 極が虚軸に近づくと、振動的になる
- 安定性の境界は虚軸上

### 4.4 根軌跡を用いた設計

**設計手順**:

1. 所望の応答特性から、目標とする極の位置（または領域）を決定
2. その極の位置を実現するゲイン $K$ を根軌跡から読み取る
3. 必要に応じて、零点や極を追加（補償器の設計）

**設計例**:
所望の特性が $\zeta = 0.5$、$\omega_n = 2$ [rad/s] の場合：
- 目標極：$s = -1 \pm j\sqrt{3}$
- これを実現する $K$ を求める

### 4.5 根軌跡法の利点と限界

**利点**:
- パラメータ変化に対するシステム特性の変化を視覚的に把握
- 安定性の判別が容易
- 設計指針を得るのに有効

**限界**:
- 1つのパラメータしか同時に変化させられない
- 定常特性は直接わからない
- 複雑なシステムでは作図が困難

## 5. 高次システムへの拡張 (Extension to Higher-Order Systems)

### 5.1 3次以上のシステム

**3次系の標準形**:

$$G(s) = \frac{\omega_n^2}{(s + p)(s^2 + 2\zeta\omega_n s + \omega_n^2)}$$

ここで、$p$ は実数極です。

**応答特性**:
- 2次系の複素共役極対が支配的であれば、2次系として近似可能
- 実数極 $p$ が十分に左側（$p \geq 5\zeta\omega_n$）にあれば影響が小さい

### 5.2 零点の影響

零点を持つシステム：

$$G(s) = \frac{s + z}{\omega_n^2} \cdot \frac{1}{s^2 + 2\zeta\omega_n s + \omega_n^2}$$

**零点の効果**:
- **左半平面の零点** ($z > 0$): 立ち上がり時間を短縮、オーバーシュート増加
- **右半平面の零点** ($z < 0$): アンダーシュート発生（非最小位相系）

**数値例**: $\zeta = 0.5$、$\omega_n = 1$ で零点 $z$ を変化させた場合：

| $z$ | $M_p$ (近似) | 応答特性 |
|-----|------------|---------|
| なし | 16.3% | 標準的な2次系 |
| $z = 10$ | 18% | わずかにオーバーシュート増加 |
| $z = 2$ | 30% | 顕著なオーバーシュート増加 |
| $z = -2$ | - | 初期にアンダーシュート発生 |

### 5.3 部分分数展開による高次系の解析

高次系の応答は、部分分数展開により基本要素の和として表現できます：

$$Y(s) = \frac{A_1}{s + p_1} + \frac{A_2}{s + p_2} + \frac{A_3 s + A_4}{(s + \alpha)^2 + \omega^2}$$

逆ラプラス変換：

$$y(t) = A_1 e^{-p_1 t} + A_2 e^{-p_2 t} + e^{-\alpha t}(A_3\cos\omega t + A_4\sin\omega t)$$

**各項の物理的意味**:
- 実数極からの寄与：指数関数的な減衰
- 複素共役極からの寄与：減衰振動

### 5.4 時間スケールの分離

システムに複数の時定数が存在する場合：

$$G(s) = \frac{K}{(T_1 s + 1)(T_2 s + 1)(T_3 s + 1)}$$

$T_1 \gg T_2 \gg T_3$ のとき：
- **遅い応答** ($T_1$) が支配的
- 速い応答 ($T_2, T_3$) は初期に減衰し、無視できる

**近似条件**:
時定数の比が5以上の場合、小さい時定数の影響は無視できます：

$$\frac{T_1}{T_2} \geq 5 \Rightarrow T_2 \text{の影響は小さい}$$

### 5.5 一般化された設計指針

高次システムの設計では：

1. **支配的極の配置**: 所望の過渡応答特性を実現
2. **非支配的極の配置**: 支配的極の5倍以上左側
3. **零点の配置**: 必要に応じて応答速度を調整（ただしオーバーシュートに注意）

**制約条件**:
- 安定性：すべての極が左半平面
- 実現可能性：物理的に実現可能な伝達関数
- ロバスト性：パラメータ変動に対する安定性

## 6. 次章への橋渡し (Bridge to Next Chapter)

### 6.1 周波数応答への展開

本章で学んだラプラス領域での極配置理論は、周波数領域の解析と密接に関連しています。

$s = j\omega$ を代入することで、伝達関数は周波数応答関数となります：

$$G(j\omega) = |G(j\omega)|e^{j\angle G(j\omega)}$$

次章では以下を学習します：
- ボード線図（Bode diagram）による周波数特性の表現
- ゲイン余裕と位相余裕
- 周波数領域での安定性判別

### 6.2 制御系設計への応用

過渡応答特性の理解は、制御系設計の基礎となります：

- **PID制御器設計**: 極配置による最適パラメータの決定
- **状態フィードバック**: 極配置法による任意の極配置
- **オブザーバ設計**: 推定誤差の収束速度の決定

### 6.3 現代制御理論への接続

**状態空間表現**では、極配置がより一般的な形で扱われます：

$$\dot{x} = Ax + Bu$$
$$y = Cx + Du$$

システムの極は、システム行列 $A$ の固有値として現れます。状態フィードバック $u = -Kx$ により、閉ループ系の極を任意に配置可能（可制御性の条件下）。

---

## まとめ

この理解者向け技術ノートでは、以下の発展的内容を学びました：

1. **2次系の一般解の完全な導出**:
   - 不足減衰、臨界減衰、過減衰の各ケースにおける解析解
   - 複素共役極、重根、実数極の場合の数学的取り扱い

2. **特性値の数学的導出**:
   - ピーク時間 $T_p = \frac{\pi}{\omega_d}$ の導出
   - 最大オーバーシュート $M_p = e^{-\frac{\zeta\pi}{\sqrt{1-\zeta^2}}} \times 100\%$ の導出
   - 整定時間 $T_s \approx \frac{4}{\zeta\omega_n}$ の理論的背景
   - 立ち上がり時間の正確な表現

3. **極配置と応答速度の関係**:
   - s平面上の極の位置表現（極座標形式）
   - 極の実部と減衰特性、虚部と振動特性の関係
   - 等減衰比線と等固有振動数線
   - 支配的極の概念と高次系の2次近似

4. **根軌跡法の基礎**:
   - 根軌跡の定義と物理的意味
   - 根軌跡の基本ルール（開始点・終点、漸近線、実軸上の軌跡）
   - ゲイン変化に伴う極の移動パターン
   - 根軌跡を用いた制御系設計の基本手順

5. **高次システムへの拡張**:
   - 3次以上のシステムにおける支配的極の役割
   - 零点が過渡応答に与える影響
   - 部分分数展開による高次系の解析手法
   - 時間スケールの分離と近似
   - 一般化された設計指針

これらの深い理解により、制御系の過渡特性に関する確固たる理論的基盤が確立されました。次章では、周波数領域での解析手法（ボード線図、ナイキスト線図）を学習し、時間領域と周波数領域の統合的な理解を目指します。

**重要な設計指針のまとめ**:
- 速い応答：極を左側に配置（$\omega_n$ を大きく）
- 適度な減衰：$0.4 < \zeta < 0.8$
- オーバーシュート制限：$M_p < 20\%$ → $\zeta > 0.45$
- 高次系の設計：支配的極の配置 + 非支配的極の分離

---

**参考文献**:
- 制御工学の理論と応用
- 根軌跡法による制御系設計
- 線形システム理論
- 現代制御理論への入門
