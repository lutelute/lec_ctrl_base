# 第13章 制御系の周波数特性 - 中級編

## 1. ボード線図の作成手順 (Bode Diagram Construction)

### 1.1 伝達関数からボード線図を作成する基本ステップ

伝達関数 $G(s)$ からボード線図を作成するには、以下の手順を踏みます：

**ステップ1: 周波数応答への変換**
$$G(s) \rightarrow G(j\omega) \quad (s = j\omega)$$

**ステップ2: 極と零点の展開**
$$G(j\omega) = K \frac{(j\omega + z_1)(j\omega + z_2)\cdots}{(j\omega + p_1)(j\omega + p_2)\cdots}$$

**ステップ3: 振幅と位相の計算**
$$|G(j\omega)| = K \frac{|j\omega + z_1| \cdot |j\omega + z_2| \cdots}{|j\omega + p_1| \cdot |j\omega + p_2| \cdots}$$

$$\arg(G(j\omega)) = \arg(z_1) + \arg(z_2) + \cdots - \arg(p_1) - \arg(p_2) - \cdots$$

**ステップ4: デシベル変換**
$$\text{ゲイン [dB]} = 20\log_{10}|G(j\omega)|$$

> **注意**: ボード線図の最大の利点は、各要素の寄与を**加算的**に扱えることです。これにより、複雑なシステムも要素ごとに分解して理解できます。

### 1.2 1次遅れ系のボード線図作成

**伝達関数**:
$$G(s) = \frac{K}{1 + Ts}$$

ここで、$K$ はゲイン定数、$T$ は時定数 [s] です。

**周波数応答**:
$$G(j\omega) = \frac{K}{1 + j\omega T}$$

**振幅の計算**:
$$|G(j\omega)| = \frac{K}{\sqrt{1 + (\omega T)^2}}$$

**位相の計算**:
$$\arg(G(j\omega)) = -\arctan(\omega T)$$

**ゲイン線図の漸近線近似**:

- **低周波領域** ($\omega \ll 1/T$):
  $$\text{ゲイン} \approx 20\log_{10}K \quad \text{[dB]} \quad (\text{水平線})$$

- **高周波領域** ($\omega \gg 1/T$):
  $$\text{ゲイン} \approx 20\log_{10}K - 20\log_{10}(\omega T) \quad \text{[dB]} \quad (-20 \text{ dB/decade})$$

- **折点周波数** ($\omega = 1/T$):
  $$\text{ゲイン} = 20\log_{10}K - 20\log_{10}\sqrt{2} \approx 20\log_{10}K - 3 \quad \text{[dB]}$$

**位相線図の特徴**:

| 周波数 | 位相 |
|--------|------|
| $\omega = 0.1/T$ | -5.7° |
| $\omega = 1/T$ | -45° |
| $\omega = 10/T$ | -84.3° |
| $\omega \rightarrow \infty$ | -90° |

**例題1**: $K = 2$、$T = 0.1$ s のとき、$\omega = 10$ rad/s でのゲインと位相を求めよ。

**解**:
$$|G(j10)| = \frac{2}{\sqrt{1 + (10 \times 0.1)^2}} = \frac{2}{\sqrt{1 + 1}} = \frac{2}{\sqrt{2}} = \sqrt{2} \approx 1.414$$

$$\text{ゲイン} = 20\log_{10}(1.414) \approx 3.0 \text{ dB}$$

$$\arg(G(j10)) = -\arctan(10 \times 0.1) = -\arctan(1) = -45°$$

### 1.3 2次遅れ系のボード線図作成

**標準形伝達関数**:
$$G(s) = \frac{\omega_n^2}{s^2 + 2\zeta\omega_n s + \omega_n^2}$$

ここで：
- $\omega_n$ は**固有角周波数 (natural frequency)** [rad/s]
- $\zeta$ は**減衰比 (damping ratio)** （無次元）

**周波数応答**:
$$G(j\omega) = \frac{\omega_n^2}{-\omega^2 + 2j\zeta\omega_n\omega + \omega_n^2} = \frac{\omega_n^2}{(\omega_n^2 - \omega^2) + 2j\zeta\omega_n\omega}$$

**振幅の計算**:
$$|G(j\omega)| = \frac{\omega_n^2}{\sqrt{(\omega_n^2 - \omega^2)^2 + (2\zeta\omega_n\omega)^2}}$$

**位相の計算**:
$$\arg(G(j\omega)) = -\arctan\left(\frac{2\zeta\omega_n\omega}{\omega_n^2 - \omega^2}\right)$$

**共振ピークの特徴**:

減衰比 $\zeta < 1/\sqrt{2} \approx 0.707$ のとき、共振ピークが現れます。

**共振周波数**:
$$\omega_r = \omega_n\sqrt{1 - 2\zeta^2} \quad (\zeta < 1/\sqrt{2})$$

**共振ピーク（ゲイン）**:
$$M_r = \frac{1}{2\zeta\sqrt{1 - \zeta^2}} \quad (\zeta < 1/\sqrt{2})$$

$$M_r \text{ [dB]} = -20\log_{10}(2\zeta\sqrt{1 - \zeta^2})$$

**例題2**: $\omega_n = 10$ rad/s、$\zeta = 0.3$ のとき、共振周波数と共振ピークを求めよ。

**解**:
$$\omega_r = 10\sqrt{1 - 2 \times 0.3^2} = 10\sqrt{1 - 0.18} = 10\sqrt{0.82} \approx 9.06 \text{ rad/s}$$

$$M_r = \frac{1}{2 \times 0.3 \times \sqrt{1 - 0.3^2}} = \frac{1}{0.6 \times \sqrt{0.91}} = \frac{1}{0.573} \approx 1.75$$

$$M_r \text{ [dB]} = 20\log_{10}(1.75) \approx 4.86 \text{ dB}$$

> **注意**: 減衰比 $\zeta$ が小さいほど共振ピークが高くなり、時間応答でのオーバーシュートも大きくなります。

### 1.4 複合システムのボード線図

複数の要素が直列に接続された場合：
$$G(s) = G_1(s) \cdot G_2(s) \cdot G_3(s)$$

**ボード線図の加算性**:
$$\text{ゲイン}[G(j\omega)] = \text{ゲイン}[G_1(j\omega)] + \text{ゲイン}[G_2(j\omega)] + \text{ゲイン}[G_3(j\omega)]$$

$$\text{位相}[G(j\omega)] = \text{位相}[G_1(j\omega)] + \text{位相}[G_2(j\omega)] + \text{位相}[G_3(j\omega)]$$

**例題3**: 以下の伝達関数のボード線図を作成せよ。
$$G(s) = \frac{50}{s(1 + 0.1s)(1 + 0.01s)}$$

**解**: 3つの要素に分解します：
1. $G_1(s) = \frac{50}{s}$ （積分器）
2. $G_2(s) = \frac{1}{1 + 0.1s}$ （時定数 $T_1 = 0.1$ s の1次遅れ）
3. $G_3(s) = \frac{1}{1 + 0.01s}$ （時定数 $T_2 = 0.01$ s の1次遅れ）

**各要素の特性**:
- $G_1$: ゲイン -20 dB/decade、位相 -90°
- $G_2$: 折点周波数 $\omega_1 = 1/0.1 = 10$ rad/s
- $G_3$: 折点周波数 $\omega_2 = 1/0.01 = 100$ rad/s

**合成ゲイン線図**:
- $\omega < 10$ rad/s: -20 dB/decade
- $10 < \omega < 100$ rad/s: -40 dB/decade
- $\omega > 100$ rad/s: -60 dB/decade

**合成位相線図**:
- 低周波: -90°
- 高周波: -90° - 90° - 90° = -270°

## 2. 安定性余裕の計算法 (Calculation of Stability Margins)

### 2.1 ゲイン余裕の計算手順

**定義の復習**:
$$\text{GM [dB]} = -20\log_{10}|G(j\omega_{pc})|$$

ここで、$\omega_{pc}$ は**位相交差周波数 (phase crossover frequency)**、すなわち $\arg(G(j\omega_{pc})) = -180°$ となる周波数です。

**計算手順**:

**ステップ1**: 位相交差周波数 $\omega_{pc}$ を求める
$$\arg(G(j\omega_{pc})) = -180°$$

**ステップ2**: その周波数でのゲインを計算
$$|G(j\omega_{pc})|$$

**ステップ3**: ゲイン余裕を計算
$$\text{GM [dB]} = -20\log_{10}|G(j\omega_{pc})|$$

または、線形単位で：
$$\text{GM (linear)} = \frac{1}{|G(j\omega_{pc})|}$$

**例題4**: 以下の伝達関数のゲイン余裕を求めよ。
$$G(s) = \frac{100}{s(1 + s)(1 + 0.1s)}$$

**解**:

**ステップ1**: 周波数応答
$$G(j\omega) = \frac{100}{j\omega(1 + j\omega)(1 + 0.1j\omega)}$$

**ステップ2**: 位相の計算
$$\arg(G(j\omega)) = -90° - \arctan(\omega) - \arctan(0.1\omega)$$

位相が -180° となる周波数を求める：
$$-90° - \arctan(\omega_{pc}) - \arctan(0.1\omega_{pc}) = -180°$$

$$\arctan(\omega_{pc}) + \arctan(0.1\omega_{pc}) = 90°$$

これを数値的に解くと、$\omega_{pc} \approx 3.16$ rad/s

**ステップ3**: $\omega_{pc}$ でのゲイン
$$|G(j3.16)| = \frac{100}{3.16 \times \sqrt{1 + 3.16^2} \times \sqrt{1 + (0.1 \times 3.16)^2}}$$

$$= \frac{100}{3.16 \times 3.32 \times 1.05} \approx 9.1$$

**ステップ4**: ゲイン余裕
$$\text{GM [dB]} = -20\log_{10}(9.1) \approx -19.2 \text{ dB}$$

> **警告**: この例ではゲイン余裕が負です。これは**不安定**を意味します！

### 2.2 位相余裕の計算手順

**定義の復習**:
$$\text{PM [deg]} = 180° + \arg(G(j\omega_{gc}))$$

ここで、$\omega_{gc}$ は**ゲイン交差周波数 (gain crossover frequency)**、すなわち $|G(j\omega_{gc})| = 1$ となる周波数です。

**計算手順**:

**ステップ1**: ゲイン交差周波数 $\omega_{gc}$ を求める
$$|G(j\omega_{gc})| = 1 \quad \text{または} \quad 20\log_{10}|G(j\omega_{gc})| = 0 \text{ dB}$$

**ステップ2**: その周波数での位相を計算
$$\arg(G(j\omega_{gc}))$$

**ステップ3**: 位相余裕を計算
$$\text{PM [deg]} = 180° + \arg(G(j\omega_{gc}))$$

**例題5**: 以下の伝達関数の位相余裕を求めよ。
$$G(s) = \frac{10}{s(1 + 0.5s)}$$

**解**:

**ステップ1**: 周波数応答
$$G(j\omega) = \frac{10}{j\omega(1 + 0.5j\omega)}$$

振幅：
$$|G(j\omega)| = \frac{10}{\omega\sqrt{1 + (0.5\omega)^2}}$$

**ステップ2**: ゲイン交差周波数を求める（$|G(j\omega_{gc})| = 1$）
$$\frac{10}{\omega_{gc}\sqrt{1 + (0.5\omega_{gc})^2}} = 1$$

$$10 = \omega_{gc}\sqrt{1 + 0.25\omega_{gc}^2}$$

$$100 = \omega_{gc}^2(1 + 0.25\omega_{gc}^2)$$

$$100 = \omega_{gc}^2 + 0.25\omega_{gc}^4$$

数値的に解くと、$\omega_{gc} \approx 4.36$ rad/s

**ステップ3**: $\omega_{gc}$ での位相
$$\arg(G(j4.36)) = -90° - \arctan(0.5 \times 4.36) = -90° - \arctan(2.18)$$

$$= -90° - 65.4° = -155.4°$$

**ステップ4**: 位相余裕
$$\text{PM} = 180° + (-155.4°) = 24.6°$$

> **評価**: PM ≈ 25° は最小基準（30°）を下回っています。制御系の改善が望まれます。

### 2.3 安定性余裕と時間応答の関係

周波数領域の安定性余裕は、時間領域の過渡応答特性と密接に関係しています。

**位相余裕と減衰比の近似関係**（2次系の場合）:
$$\zeta \approx \frac{\text{PM [deg]}}{100}$$

**位相余裕とオーバーシュートの関係**:
$$\text{オーバーシュート} \approx 100 \times e^{-\pi\zeta/\sqrt{1-\zeta^2}} \quad [\%]$$

| 位相余裕 | 減衰比 | オーバーシュート |
|----------|--------|------------------|
| 60° | 0.6 | 9.5% |
| 45° | 0.45 | 20.8% |
| 30° | 0.3 | 37.2% |
| 15° | 0.15 | 62.3% |

**ゲイン余裕と安定度**:

一般的な設計基準：
- **GM ≥ 6 dB** （安全マージン）
- **PM ≥ 30°** （最小基準）
- **PM ≥ 45°** （推奨値）

**例題6**: 位相余裕 40° のシステムのオーバーシュートを推定せよ。

**解**:
$$\zeta \approx \frac{40}{100} = 0.4$$

$$\text{オーバーシュート} \approx 100 \times e^{-\pi \times 0.4/\sqrt{1-0.4^2}}$$

$$= 100 \times e^{-1.256/0.917} = 100 \times e^{-1.37} \approx 25.4\%$$

### 2.4 ナイキスト線図による安定性余裕

ナイキスト線図上でも安定性余裕を視覚的に評価できます：

**ゲイン余裕（ナイキスト線図）**:
- ナイキスト軌跡と負の実軸の交点から (-1, 0) 点までの距離

**位相余裕（ナイキスト線図）**:
- 単位円（原点からの距離 = 1）とナイキスト軌跡の交点から (-1, 0) 点への角度

**ベクトル余裕 (vector margin)**:
$$\text{VM} = \min_{\omega} |1 + G(j\omega)|$$

これは (-1, 0) 点からナイキスト軌跡までの最短距離を表します。

> **注意**: ベクトル余裕は、ゲイン余裕と位相余裕を同時に考慮した、より包括的な安定性指標です。

## 3. 実用的な設計指針 (Practical Design Guidelines)

### 3.1 周波数領域での制御器設計

**設計目標の設定**:

1. **安定性の確保**:
   - GM ≥ 6 dB
   - PM ≥ 45°

2. **応答速度の指定**:
   - ゲイン交差周波数 $\omega_{gc}$ を高く → 速い応答

3. **ノイズ抑制**:
   - 高周波でのゲインを低く

**ボード線図を用いた設計ステップ**:

**ステップ1**: 開ループ伝達関数 $G(s)$ のボード線図を描く

**ステップ2**: 現状の GM、PM を評価

**ステップ3**: 制御器 $C(s)$ を追加して特性を改善
$$G_c(s) = C(s) \cdot G(s)$$

**ステップ4**: 目標仕様を満たすまで調整

### 3.2 補償器の種類と効果

**位相進み補償器 (lead compensator)**:
$$C(s) = K \frac{1 + Ts}{1 + \alpha Ts} \quad (0 < \alpha < 1)$$

- **効果**: 位相余裕を増やす、応答を速くする
- **用途**: 位相余裕が不足している場合

**位相遅れ補償器 (lag compensator)**:
$$C(s) = K \frac{1 + Ts}{1 + \beta Ts} \quad (\beta > 1)$$

- **効果**: 低周波ゲインを増やす、定常偏差を減少
- **用途**: 定常特性の改善

**PID制御器**:
$$C(s) = K_p + \frac{K_i}{s} + K_d s$$

- **比例 (P)**: ゲインの調整
- **積分 (I)**: 定常偏差の除去
- **微分 (D)**: 位相余裕の改善

> **注意**: 制御器の詳細な設計法は第14章で扱います。ここでは周波数特性への影響の理解が重要です。

### 3.3 ボード線図から読み取れる情報のまとめ

| 特徴 | 情報 |
|------|------|
| 低周波ゲイン | 定常ゲイン、定常偏差 |
| ゲイン交差周波数 | 応答速度（帯域幅） |
| ゲイン傾斜 | システムの型（積分器の数） |
| 共振ピーク | 減衰比、オーバーシュート |
| 高周波減衰 | ノイズ抑制性能 |
| GM、PM | 安定性余裕、ロバスト性 |

**周波数帯域の分類**:
- **低周波** ($\omega < \omega_{gc}$): 定常特性、外乱抑制
- **中周波** ($\omega \approx \omega_{gc}$): 過渡応答、安定性余裕
- **高周波** ($\omega > \omega_{gc}$): ノイズ抑制、センサ雑音

---

## まとめ

この中級編では、以下を学びました：

- 伝達関数から1次遅れ系、2次遅れ系のボード線図を作成する詳細な手順
- 複合システムのボード線図を要素ごとの加算で構成する方法
- ゲイン余裕と位相余裕の厳密な定義と計算手順
- 位相交差周波数とゲイン交差周波数の求め方
- 安定性余裕と時間領域での過渡応答（減衰比、オーバーシュート）の関係
- ナイキスト線図上での安定性余裕の視覚的評価
- 周波数領域での制御器設計の基本指針

次の理解者編では、ナイキストの安定判別法の理論的背景、より複雑なシステムの解析、そしてロバスト安定性との関係について深く学習します。
