# 第5章 周波数伝達関数 - 初級編

## 1. 周波数応答入門 (Introduction to Frequency Response)

### 1.1 周波数応答とは何か

**周波数応答 (frequency response)** は、システムに正弦波（サインカーブ）の入力を加えたときに、出力がどのように応答するかを調べる方法です。

制御システムに正弦波入力 $u(t) = A\sin(\omega t)$ を加えると、十分な時間が経過した後（定常状態）、出力も正弦波になります：

$$y(t) = B\sin(\omega t + \phi)$$

ここで：
- $A$ は**入力の振幅 (input amplitude)**
- $B$ は**出力の振幅 (output amplitude)**
- $\omega$ は**角周波数 (angular frequency)** [rad/s]
- $\phi$ は**位相差 (phase difference)** [rad または deg]

**重要な発見**：
- 出力の振幅 $B$ は入力の振幅 $A$ に対して変化します（振幅比 = $B/A$）
- 出力は入力に対して時間的にずれます（位相差 $\phi$）
- この振幅比と位相差は、**入力の周波数 $\omega$ に依存**します

### 1.2 なぜ周波数応答を学ぶのか

制御工学において周波数応答が重要な理由：

1. **システム特性の理解**: 異なる周波数に対するシステムの応答を知ることで、システムの性質が分かります

2. **フィルタ設計**: 特定の周波数成分を通過させたり遮断したりする設計ができます

3. **安定性の判別**: 周波数応答から制御系の安定性を調べることができます（第10章で学習）

4. **実験的な測定が可能**: 実際のシステムに様々な周波数の正弦波を入力して、出力を測定することで特性を知ることができます

### 1.3 正弦波入力と正弦波出力の関係

線形時不変システム（LTI: Linear Time-Invariant system）には重要な性質があります：

> **重要な性質**: LTIシステムに正弦波を入力すると、出力は同じ周波数の正弦波になります。変わるのは振幅と位相だけです。

**例**：
あるシステムに $u(t) = 2\sin(3t)$ を入力したとき、出力が $y(t) = 1.2\sin(3t - 0.5)$ になったとします。
- 入力振幅: $A = 2$
- 出力振幅: $B = 1.2$
- 振幅比（ゲイン）: $B/A = 0.6$
- 位相差: $\phi = -0.5$ rad（出力が遅れている）
- 周波数: $\omega = 3$ rad/s（入力と出力で同じ）

## 2. 正弦波の基礎 (Fundamentals of Sine Waves)

### 2.1 正弦波の表現

正弦波は以下の形式で表されます：

$$x(t) = A\sin(\omega t + \theta)$$

**パラメータの意味**：
- $A$ : **振幅 (amplitude)** - 波の高さの最大値
- $\omega$ : **角周波数 (angular frequency)** [rad/s] - 振動の速さ
- $\theta$ : **初期位相 (initial phase)** [rad] - 時刻 $t=0$ での位相
- $t$ : 時間 [s]

### 2.2 周波数の表現

周波数には2つの表現方法があります：

| 表記 | 名称 | 単位 | 関係式 |
|------|------|------|--------|
| $f$ | 周波数 (frequency) | Hz | $\omega = 2\pi f$ |
| $\omega$ | 角周波数 (angular frequency) | rad/s | $f = \frac{\omega}{2\pi}$ |

**例**：
- $f = 50$ Hz の周波数は、$\omega = 2\pi \times 50 \approx 314.16$ rad/s です
- $\omega = 10$ rad/s の角周波数は、$f = \frac{10}{2\pi} \approx 1.59$ Hz です

> **注意**: 制御工学では角周波数 $\omega$ [rad/s] を使うことが多いです。

### 2.3 複素指数表現

正弦波は**オイラーの公式 (Euler's formula)** を使って複素指数で表現できます：

$$e^{j\omega t} = \cos(\omega t) + j\sin(\omega t)$$

ここで $j$ は虚数単位（$j^2 = -1$）です。

この式から：

$$\sin(\omega t) = \frac{e^{j\omega t} - e^{-j\omega t}}{2j}$$

$$\cos(\omega t) = \frac{e^{j\omega t} + e^{-j\omega t}}{2}$$

**複素指数表現の利点**：
- 正弦波を簡潔に表現できます
- 微分や積分が簡単になります（$\frac{d}{dt}e^{j\omega t} = j\omega e^{j\omega t}$）
- 周波数応答の計算が簡単になります

## 3. 周波数伝達関数の概念 (Frequency Transfer Function)

### 3.1 伝達関数から周波数伝達関数へ

第4章で学んだ**伝達関数 (transfer function)** $G(s)$ は、ラプラス変換を使ってシステムを表現しました：

$$G(s) = \frac{Y(s)}{U(s)}$$

ここで $s$ は複素数（$s = \sigma + j\omega$）です。

**周波数伝達関数 (frequency transfer function)** $G(j\omega)$ は、伝達関数 $G(s)$ の $s$ に $j\omega$ を代入したものです：

$$G(j\omega) = G(s)|_{s=j\omega}$$

これは、純粋に虚軸上（$\sigma = 0$）での伝達関数の値を表します。

### 3.2 ゲインと位相

周波数伝達関数 $G(j\omega)$ は複素数なので、極座標形式で表現できます：

$$G(j\omega) = |G(j\omega)| e^{j\angle G(j\omega)}$$

ここで：
- $|G(j\omega)|$ : **ゲイン (gain)** - 振幅比を表します
- $\angle G(j\omega)$ : **位相 (phase)** - 位相差を表します [rad または deg]

**ゲインと位相の物理的意味**：
- **ゲイン** $|G(j\omega)|$ = 出力振幅 / 入力振幅
- **位相** $\angle G(j\omega)$ = 出力と入力の位相差（正なら進み、負なら遅れ）

### 3.3 簡単な例：1次遅れ系

**1次遅れ系 (first-order lag system)** の伝達関数：

$$G(s) = \frac{K}{1 + Ts}$$

ここで、$K$ はゲイン定数、$T$ は時定数です。

**周波数伝達関数**：
$s = j\omega$ を代入すると：

$$G(j\omega) = \frac{K}{1 + jT\omega}$$

**ゲインの計算**：

$$|G(j\omega)| = \frac{K}{\sqrt{1 + (T\omega)^2}}$$

**位相の計算**：

$$\angle G(j\omega) = -\tan^{-1}(T\omega)$$

**周波数による変化**：
- 低周波（$\omega \to 0$）: $|G(j\omega)| \to K$、$\angle G(j\omega) \to 0°$
- 高周波（$\omega \to \infty$）: $|G(j\omega)| \to 0$、$\angle G(j\omega) \to -90°$

**計算例**：
$K = 2$、$T = 0.1$ s、$\omega = 10$ rad/s のとき：

$$|G(j10)| = \frac{2}{\sqrt{1 + (0.1 \times 10)^2}} = \frac{2}{\sqrt{2}} \approx 1.414$$

$$\angle G(j10) = -\tan^{-1}(0.1 \times 10) = -\tan^{-1}(1) = -45°$$

これは、周波数 10 rad/s の正弦波入力に対して：
- 出力振幅は入力の約1.414倍（$K=2$の場合）
- 出力は入力より45°（約0.785 rad）遅れる

ことを意味します。

---

## まとめ

この初級編では、以下を学びました：

- 周波数応答は、正弦波入力に対するシステムの定常応答を調べる方法です
- 正弦波は振幅 $A$、角周波数 $\omega$、位相 $\theta$ で表現されます
- 複素指数表現 $e^{j\omega t}$ を使うと計算が簡単になります
- 周波数伝達関数 $G(j\omega)$ は、伝達関数 $G(s)$ に $s=j\omega$ を代入したものです
- ゲイン $|G(j\omega)|$ は振幅比を、位相 $\angle G(j\omega)$ は位相差を表します
- 1次遅れ系では、周波数が高くなるとゲインが小さくなり、位相が遅れます

次の中級編では、Bode線図（ボード線図）とNyquist線図（ナイキスト線図）を使って、周波数特性を視覚的に表現する方法を学習します。
