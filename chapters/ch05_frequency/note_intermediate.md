# 第5章 周波数伝達関数 - 中級編

## 1. 周波数伝達関数の計算 (Calculating Frequency Transfer Functions)

### 1.1 周波数伝達関数とは

初級編では、周波数応答の基本概念を学びました。中級編では、具体的な**周波数伝達関数の計算方法**と**周波数特性の図示方法**を習得します。

伝達関数 $G(s)$ に $s = j\omega$ を代入することで、**周波数伝達関数 (frequency transfer function)** が得られます：

$$G(j\omega) = |G(j\omega)|e^{j\angle G(j\omega)}$$

ここで：
- $|G(j\omega)|$ は**ゲイン (gain)** または**振幅比**：出力振幅と入力振幅の比
- $\angle G(j\omega)$ は**位相 (phase)** または**位相差**：出力と入力の位相のずれ

### 1.2 主要な伝達関数の周波数応答計算

#### (1) 比例要素 $G(s) = K$

$$G(j\omega) = K$$

- ゲイン: $|G(j\omega)| = K$
- 位相: $\angle G(j\omega) = 0°$

周波数によらず一定のゲインで、位相のずれはありません。

#### (2) 積分器 $G(s) = \frac{1}{s}$

$$G(j\omega) = \frac{1}{j\omega}$$

これを整理すると：
$$G(j\omega) = \frac{1}{j\omega} = \frac{-j}{\omega} = \frac{1}{\omega}e^{-j\pi/2}$$

- ゲイン: $|G(j\omega)| = \frac{1}{\omega}$（周波数が高くなるほど小さくなる）
- 位相: $\angle G(j\omega) = -90°$（常に90度の遅れ）

#### (3) 微分器 $G(s) = s$

$$G(j\omega) = j\omega = \omega e^{j\pi/2}$$

- ゲイン: $|G(j\omega)| = \omega$（周波数が高くなるほど大きくなる）
- 位相: $\angle G(j\omega) = +90°$（常に90度の進み）

#### (4) 1次遅れ系 $G(s) = \frac{K}{1+Ts}$

$$G(j\omega) = \frac{K}{1+j\omega T}$$

分母を実数化するため、分子分母に複素共役を掛けます：
$$G(j\omega) = \frac{K}{1+j\omega T} \cdot \frac{1-j\omega T}{1-j\omega T} = \frac{K(1-j\omega T)}{1+(\omega T)^2}$$

- ゲイン: $|G(j\omega)| = \frac{K}{\sqrt{1+(\omega T)^2}}$
- 位相: $\angle G(j\omega) = -\tan^{-1}(\omega T)$

**低周波数（$\omega \to 0$）**: ゲイン $\approx K$、位相 $\approx 0°$
**高周波数（$\omega \to \infty$）**: ゲイン $\to 0$、位相 $\to -90°$
**折れ点周波数（$\omega = 1/T$）**: ゲイン $= K/\sqrt{2} \approx 0.707K$、位相 $= -45°$

#### (5) 2次系 $G(s) = \frac{\omega_n^2}{s^2 + 2\zeta\omega_n s + \omega_n^2}$

$$G(j\omega) = \frac{\omega_n^2}{\omega_n^2 - \omega^2 + j2\zeta\omega_n\omega}$$

- ゲイン: $|G(j\omega)| = \frac{\omega_n^2}{\sqrt{(\omega_n^2-\omega^2)^2 + (2\zeta\omega_n\omega)^2}}$
- 位相: $\angle G(j\omega) = -\tan^{-1}\left(\frac{2\zeta\omega_n\omega}{\omega_n^2-\omega^2}\right)$

**共振周波数（$\zeta < 1/\sqrt{2}$ のとき）**: $\omega_r = \omega_n\sqrt{1-2\zeta^2}$ でゲインがピークとなる
**減衰比 $\zeta$ が小さい**ほど、共振ピークが大きくなります。

### 1.3 周波数特性計算の手順

1. 伝達関数 $G(s)$ に $s = j\omega$ を代入
2. 複素数を $a + jb$ の形に整理
3. ゲイン $|G(j\omega)| = \sqrt{a^2 + b^2}$ を計算
4. 位相 $\angle G(j\omega) = \tan^{-1}(b/a)$ を計算

**例**: $G(s) = \frac{2}{1+0.5s}$ の場合、$\omega = 2$ [rad/s] での周波数応答は：
- $G(j2) = \frac{2}{1+j1} = \frac{2(1-j)}{2} = 1 - j$
- ゲイン: $|G(j2)| = \sqrt{1^2 + (-1)^2} = \sqrt{2} \approx 1.414$
- 位相: $\angle G(j2) = \tan^{-1}(-1/1) = -45°$

## 2. Bode線図（ボード線図）(Bode Diagram)

### 2.1 Bode線図とは

**Bode線図 (Bode diagram)** は、周波数応答を2つのグラフで表現する方法です：

1. **ゲイン線図 (gain plot)**: 周波数に対するゲインの変化を対数グラフで表示
2. **位相線図 (phase plot)**: 周波数に対する位相の変化を表示

**横軸**: 周波数 $\omega$ [rad/s]（対数スケール）
**縦軸（ゲイン線図）**: ゲイン [dB]（デシベル）
**縦軸（位相線図）**: 位相 [deg]（度）または [rad]（ラジアン）

### 2.2 対数スケールとdB表示

#### 対数スケール (Logarithmic Scale)

周波数軸は**対数スケール**で表示します。これにより、広い周波数範囲を見やすく表示できます：

- 0.1, 1, 10, 100, 1000 [rad/s] が等間隔に表示される
- 周波数が10倍変化することを**1 decade（デケード）** と呼ぶ

#### dB表示 (Decibel Notation)

ゲインは**デシベル (dB)** で表示します：

$$\text{ゲイン [dB]} = 20\log_{10}|G(j\omega)|$$

**dB表示の利点**:
- 掛け算が足し算になる：$|G_1 G_2| = |G_1| + |G_2|$ [dB]
- 割り算が引き算になる：$|G_1/G_2| = |G_1| - |G_2|$ [dB]
- 広い範囲のゲインを見やすく表示できる

**重要な対応関係**:
- ゲイン 1 = 0 dB
- ゲイン 2 ≈ 6 dB
- ゲイン 10 = 20 dB
- ゲイン 0.1 = -20 dB
- ゲイン 0.5 ≈ -6 dB
- ゲイン 1/√2 ≈ 0.707 ≈ -3 dB

### 2.3 各基本要素のBode線図

#### (1) 比例要素 $K$

- **ゲイン線図**: 水平線（$20\log K$ [dB]）
- **位相線図**: 水平線（0°）

#### (2) 積分器 $\frac{1}{s}$

- **ゲイン線図**: 傾き -20 dB/decade の直線（$\omega$ が10倍になるごとに -20 dB）
- **位相線図**: 水平線（-90°）

#### (3) 微分器 $s$

- **ゲイン線図**: 傾き +20 dB/decade の直線
- **位相線図**: 水平線（+90°）

#### (4) 1次遅れ系 $\frac{1}{1+Ts}$

**折れ点周波数**: $\omega_c = 1/T$

- **低周波数（$\omega \ll \omega_c$）**: ゲイン ≈ 0 dB、位相 ≈ 0°
- **高周波数（$\omega \gg \omega_c$）**: ゲイン傾き -20 dB/decade、位相 ≈ -90°
- **折れ点周波数（$\omega = \omega_c$）**: ゲイン ≈ -3 dB、位相 = -45°

**近似による描画**:
- $\omega < \omega_c$: 水平線（0 dB）
- $\omega > \omega_c$: 傾き -20 dB/decade の直線
- 折れ点で2つの直線が交差（実際の曲線は滑らかに変化）

### 2.4 Bode線図の描き方の手順

複合系 $G(s) = G_1(s) \cdot G_2(s) \cdots G_n(s)$ の場合：

1. 各要素を因数分解する
2. 各要素の折れ点周波数を見つける
3. 各要素のBode線図を描く
4. dB表示では、各要素のゲインを**加算**する
5. 位相も各要素を**加算**する

**例**: $G(s) = \frac{10}{s(1+0.1s)}$ の場合
- $G_1(s) = 10$: 20 dB の水平線
- $G_2(s) = 1/s$: -20 dB/decade の傾き
- $G_3(s) = \frac{1}{1+0.1s}$: 折れ点 $\omega = 10$ rad/s で -20 dB/decade

**合成**:
- $\omega < 10$: 傾き -20 dB/decade
- $\omega > 10$: 傾き -40 dB/decade（-20 + (-20)）

## 3. Nyquist線図（ナイキスト線図）(Nyquist Diagram)

### 3.1 Nyquist線図とは

**Nyquist線図 (Nyquist diagram)** は、周波数伝達関数 $G(j\omega)$ を**複素平面上の軌跡**として表現する方法です。

- **横軸**: 実部 $\text{Re}[G(j\omega)]$
- **縦軸**: 虚部 $\text{Im}[G(j\omega)]$
- **軌跡**: $\omega$ を 0 から $\infty$ まで変化させたときの $G(j\omega)$ の軌跡

### 3.2 Nyquist線図の描き方

#### 基本手順

1. $G(j\omega) = a(\omega) + jb(\omega)$ の形に整理
2. 実部 $a(\omega)$ と虚部 $b(\omega)$ を計算
3. $\omega = 0, 0.1, 1, 10, \infty$ などの点で $(a, b)$ を計算
4. 複素平面上に点をプロットし、滑らかな曲線で結ぶ
5. 矢印で $\omega$ が増加する方向を示す

#### 特徴的な点

- **開始点（$\omega = 0$）**: 通常、実軸上または原点
- **終点（$\omega \to \infty$）**: 原点または実軸上の点
- **実軸との交点**: 虚部が0となる周波数
- **虚軸との交点**: 実部が0となる周波数

### 3.3 主要な伝達関数のNyquist線図

#### (1) 積分器 $G(s) = \frac{1}{s}$

$$G(j\omega) = \frac{-j}{\omega}$$

- 実部: 0
- 虚部: $-1/\omega$

**軌跡**: 負の虚軸上を原点から下に向かって無限遠へ（$\omega: 0 \to \infty$）

#### (2) 1次遅れ系 $G(s) = \frac{K}{1+Ts}$

$$G(j\omega) = \frac{K}{1+(\omega T)^2} - j\frac{K\omega T}{1+(\omega T)^2}$$

- $\omega = 0$: $(K, 0)$
- $\omega = 1/T$: $(K/2, -K/2)$
- $\omega \to \infty$: $(0, 0)$

**軌跡**: 点 $(K, 0)$ から原点へ向かう半円状の曲線（第4象限）

#### (3) 2次系

減衰比 $\zeta$ の値により軌跡の形状が変化：
- $\zeta > 1$: 実軸上の曲線
- $\zeta = 1$: 境界ケース
- $0 < \zeta < 1$: 原点を通らない曲線、虚軸方向に大きく張り出す

### 3.4 Bode線図とNyquist線図の関係

同じ周波数応答を異なる形式で表現しています：

| 特性 | Bode線図 | Nyquist線図 |
|------|---------|-------------|
| 表示形式 | ゲインと位相を別々に表示 | 複素平面上の1つの軌跡 |
| 周波数軸 | 横軸に対数表示 | パラメータとして軌跡上に表示 |
| ゲイン情報 | 縦軸に直接表示（dB） | 原点からの距離 |
| 位相情報 | 別グラフで表示 | 実軸とのなす角度 |
| 安定性判別 | 直感的には難しい | Nyquist安定判別法に使用可能 |

**周波数 $\omega$ での関係**:
- Bode線図のゲイン = Nyquist線図の原点からの距離 $|G(j\omega)|$
- Bode線図の位相 = Nyquist線図の実軸とのなす角度 $\angle G(j\omega)$

### 3.5 周波数特性の読み取り例

**例**: ある点が $(0.5, -0.5)$ にある場合
- 距離: $|G(j\omega)| = \sqrt{0.5^2 + 0.5^2} = \frac{1}{\sqrt{2}} \approx 0.707$ → -3 dB
- 角度: $\angle G(j\omega) = \tan^{-1}(-0.5/0.5) = -45°$

---

## まとめ

この中級編では、以下を学びました：

- 周波数伝達関数 $G(j\omega)$ の計算方法とゲイン・位相の求め方
- 主要な伝達関数（比例、積分器、微分器、1次遅れ系、2次系）の周波数応答
- Bode線図の描き方：dB表示、対数スケール、折れ点周波数
- 基本要素のBode線図と複合系での加算法則
- Nyquist線図の描き方：複素平面上の軌跡表現
- 主要な伝達関数のNyquist線図の特徴
- Bode線図とNyquist線図の相互関係

次の上級編では、ゲイン特性と位相特性の詳細解析、帯域幅や共振周波数などの概念、そして制御設計への応用について学習します。
