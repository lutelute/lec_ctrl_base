# 第10章 FBシステムの安定性 - 理解者向け技術ノート

## 1. ラウス法の特殊ケース (Special Cases of Routh Criterion)

### 1.1 第1列にゼロが現れる場合 (Zero in First Column)

ラウス配列の第1列に**ゼロ**が現れる場合、計算を続けることができなくなります。この場合、**εメソッド (epsilon method)** を使用します。

**手順**：
1. ゼロを小さな正の数 $\varepsilon$ で置き換える
2. ラウス配列の計算を続ける
3. $\varepsilon \to 0^+$ の極限を取る
4. 符号変化を数える

**例題1**: 第1列にゼロが現れるケース

特性方程式 $s^4 + s^3 + 3s^2 + 2s + 5 = 0$ を考えます。

ラウス配列：

$$\begin{aligned}
s^4 &: \quad 1 \quad 3 \quad 5 \\
s^3 &: \quad 1 \quad 2 \quad 0 \\
s^2 &: \quad \frac{1 \cdot 3 - 1 \cdot 2}{1} = 1 \quad 5 \\
s^1 &: \quad \frac{1 \cdot 2 - 1 \cdot 5}{1} = -3 \quad 0 \\
s^0 &: \quad 5
\end{aligned}$$

この場合、$s^1$ の行で計算結果が $-3$ となり、問題なく計算できました。しかし、もし $s^1$ で 0 になった場合は：

$$s^1: \quad 0 \to \varepsilon \quad (\varepsilon > 0)$$

と置き換えて計算を続けます。$\varepsilon \to 0^+$ の極限で符号を判定します。

### 1.2 行全体がゼロになる場合 (Row of Zeros)

ラウス配列のある行が**すべてゼロ**になる場合、これは**補助方程式 (auxiliary equation)** を示します。

**手順**：
1. ゼロの行の直前の行から補助多項式を構成する
2. 補助多項式を微分する
3. その係数で計算を続ける

**例題2**: 行がゼロになるケース

特性方程式 $s^4 + 2s^3 + 3s^2 + 2s + 2 = 0$ を考えます。

ラウス配列：

$$\begin{aligned}
s^4 &: \quad 1 \quad 3 \quad 2 \\
s^3 &: \quad 2 \quad 2 \quad 0 \\
s^2 &: \quad \frac{2 \cdot 3 - 1 \cdot 2}{2} = 2 \quad 2 \\
s^1 &: \quad \frac{2 \cdot 2 - 2 \cdot 2}{2} = 0 \quad 0 \quad \leftarrow \text{すべてゼロ}
\end{aligned}$$

$s^2$ の行から補助多項式を構成：

$$A(s) = 2s^2 + 2$$

これを微分：

$$\frac{dA(s)}{ds} = 4s$$

この係数を使って計算を続けます：

$$\begin{aligned}
s^1 &: \quad 4 \quad 0 \\
s^0 &: \quad 2
\end{aligned}$$

第1列は $1, 2, 2, 4, 2$ となり、符号変化はありません。ただし、補助方程式 $2s^2 + 2 = 0$ は $s = \pm j$ を持ち、これは**虚軸上の極**を意味するため、系は**限界安定**です。

### 1.3 特殊ケースの物理的意味

**ゼロの出現**：
- 第1列にゼロ：虚軸上または対称な極の存在を示唆
- 行全体がゼロ：虚軸上の極の存在を確実に示す

実用上、これらは**限界安定**または**不安定**を意味し、設計として望ましくありません。

---

## 2. ナイキスト安定判別法の厳密な理論 (Rigorous Nyquist Stability Criterion)

### 2.1 ナイキストの基本定理

**ナイキスト安定判別法 (Nyquist stability criterion)** の厳密な形は、複素関数論の**偏角の原理 (argument principle)** に基づいています。

開ループ伝達関数を $L(s) = G(s)H(s)$ とし、閉ループ特性方程式は：

$$1 + L(s) = 0$$

**ナイキストの定理**：

$$Z = N + P$$

ここで：
- $Z$：閉ループ系の**右半平面極の個数** (Right Half-Plane zeros of $1 + L(s)$)
- $P$：開ループ伝達関数 $L(s)$ の**右半平面極の個数**
- $N$：ナイキスト線図が点 $(-1, 0)$ を**囲む回数**（反時計回りを正）

**安定条件**：

$$Z = 0 \quad \Leftrightarrow \quad N = -P$$

### 2.2 ナイキスト経路 (Nyquist Path)

ナイキスト線図を描くための経路は、以下の3つの部分から構成されます：

1. **正の虚軸**：$s = j\omega$ ($\omega: 0 \to +\infty$)
2. **無限大の半円**：$s = Re^{j\theta}$ ($\theta: 90° \to -90°$, $R \to \infty$)
3. **負の虚軸**：$s = j\omega$ ($\omega: -\infty \to 0$)

実用上は、**対称性**により正の虚軸のみをプロットし、複素共役を考慮します。

### 2.3 囲み回数の数え方 (Counting Encirclements)

点 $(-1, 0)$ の囲み回数 $N$ は、以下のように数えます：

**方法1**: ベクトル法
- $\omega$ を $0$ から $\infty$ まで変化させる
- 点 $(-1, 0)$ から軌跡へのベクトルの回転角度を累積
- 反時計回りの360°回転ごとに $N = +1$
- 時計回りの360°回転ごとに $N = -1$

**方法2**: 交差法
- 軌跡が負の実軸（$-1, 0$ より左側）を横切る回数を数える
- 下から上への横切り：$N = +0.5$
- 上から下への横切り：$N = -0.5$

**例題3**: 2次系のナイキスト線図

開ループ伝達関数 $L(s) = \frac{K}{s(s+1)}$ を考えます（$K > 0$）。

$s = j\omega$ を代入：

$$L(j\omega) = \frac{K}{j\omega(j\omega+1)} = \frac{K}{-\omega^2 + j\omega}$$

$$L(j\omega) = \frac{K(-\omega^2 - j\omega)}{\omega^4 + \omega^2} = \frac{-K\omega^2}{\omega^2(1+\omega^2)} + j\frac{-K\omega}{\omega^2(1+\omega^2)}$$

$$L(j\omega) = \frac{-K}{1+\omega^2} - j\frac{K}{\omega(1+\omega^2)}$$

**極限値**：
- $\omega \to 0^+$: $L(j\omega) \to -jK/\omega \to -j\infty$ (下方)
- $\omega \to \infty$: $L(j\omega) \to 0$

軌跡は虚軸の負側から原点へと収束します。$(-1, 0)$ を囲むかどうかは $K$ の値によります：
- $K < 1$: 囲まない ($N = 0$)
- $K > 1$: 囲む ($N = -2$, 時計回り)

開ループ極数 $P = 0$ (原点の極は虚軸上) なので：
- $K < 1$: $Z = N + P = 0$ → **安定**
- $K > 1$: $Z = -2 + 0 = -2$ → **不安定** (2つの右半平面極)

---

## 3. 開ループ不安定系とナイキスト軌跡 (Unstable Open-Loop Systems and Nyquist Locus)

### 3.1 開ループ不安定系の取り扱い

開ループ系が不安定な場合（$P > 0$）でも、ナイキスト判別法は適用可能です。この場合、適切な囲み回数 $N = -P$ が必要です。

**例題4**: 開ループ不安定系

開ループ伝達関数 $L(s) = \frac{K(s-1)}{(s+2)(s+3)}$ を考えます。

この系は右半平面に零点 $s = 1$ を持ちますが、極は左半平面にあるため $P = 0$ です。

しかし、もし極が右半平面にある場合：

$$L(s) = \frac{K}{(s-1)(s+2)}$$

この場合、$P = 1$ (極 $s = 1$ が右半平面) です。

閉ループ系が安定となるには：

$$Z = 0 \quad \Rightarrow \quad N = -P = -1$$

つまり、ナイキスト線図は $(-1, 0)$ を**時計回りに1回**囲む必要があります。

### 3.2 右半平面零点と非最小位相系 (RHP Zeros and Non-Minimum Phase Systems)

開ループ伝達関数が**右半平面零点 (RHP zero)** を持つ場合、**非最小位相系 (non-minimum phase system)** と呼ばれます。

$$G(s) = \frac{K(s-z)}{(s+p_1)(s+p_2)} \quad (z > 0)$$

このような系では：
- ゲインが増加しても位相が進まない
- ステップ応答が逆応答 (inverse response) を示すことがある
- 安定化が困難

非最小位相系の例：
- **航空機の高度制御**: エレベータ動作時の初期逆応答
- **化学プラント**: 加熱時の温度の一時的な低下

### 3.3 時間遅れ系のナイキスト線図

**時間遅れ (time delay)** $e^{-Ls}$ を含む系も、ナイキスト法で解析できます：

$$G(s) = \frac{K e^{-Ls}}{s+1}$$

$s = j\omega$ を代入すると：

$$G(j\omega) = \frac{K e^{-jL\omega}}{j\omega+1}$$

時間遅れは位相を無限に遅らせるため：

$$\angle e^{-jL\omega} = -L\omega \quad (\text{rad})$$

遅れが大きいほど、安定化が困難になります。

---

## 4. 安定余裕と過渡応答の関係 (Relationship between Stability Margins and Transient Response)

### 4.1 位相余裕と減衰係数の関係

2次標準系において、**位相余裕 (PM)** と**減衰係数 $\zeta$** の間には近似的な関係があります：

$$PM \approx 100 \zeta \quad (\text{度})$$

または、より正確には：

$$\zeta \approx \frac{PM}{100} \quad (PM \text{ in degrees})$$

**実用的な設計指針**：

$$PM \geq 45° \quad \Rightarrow \quad \zeta \geq 0.45$$

これにより、適度な減衰特性（オーバーシュート約25%以下）が保証されます。

### 4.2 ゲイン余裕とロバスト性

**ゲイン余裕 (GM)** は、モデル化誤差やパラメータ変動に対する**ロバスト性 (robustness)** の指標です。

$$GM_{dB} \geq 6 \, \text{dB} \quad (\text{倍数で約2倍})$$

これは、実際のプラントゲインが設計値の**2倍**になっても安定性を保てることを意味します。

**実用的な推奨値**：
- $GM \geq 6$ dB: 最低限の余裕
- $GM \geq 12$ dB: 十分な余裕（4倍のゲイン変動に耐える）

### 4.3 余裕と感度関数の関係

閉ループ系の**感度関数 (sensitivity function)** $S(s)$ は：

$$S(s) = \frac{1}{1 + L(s)}$$

ここで、$L(s) = G(s)H(s)$ は開ループ伝達関数です。

感度のピーク値 $M_s$ と位相余裕の関係：

$$M_s = \max_{\omega} |S(j\omega)| \approx \frac{1}{2\sin(PM/2)}$$

**設計指針**：
- $M_s \leq 2.0$: 十分な余裕（$PM \geq 29°$）
- $M_s \leq 1.5$: より良い余裕（$PM \geq 41°$）

### 4.4 ゲイン交差周波数と応答速度

**ゲイン交差周波数 $\omega_{gc}$** は、閉ループ系の応答速度と密接に関係します：

$$\omega_{gc} \approx \omega_{\text{BW}}$$

ここで、$\omega_{\text{BW}}$ は閉ループ系の**帯域幅 (bandwidth)** です。

**設計のトレードオフ**：
- $\omega_{gc}$ を大きくする → 応答が速い、位相余裕が減少
- $\omega_{gc}$ を小さくする → 位相余裕が増加、応答が遅い

---

## 5. 位相進み補償器設計 (Lead Compensator Design)

### 5.1 位相進み補償器の伝達関数

**位相進み補償器 (lead compensator)** は、位相余裕を改善するために使用されます：

$$G_c(s) = K_c \frac{s + z}{s + p} \quad (0 < z < p)$$

または、標準形で：

$$G_c(s) = K_c \frac{1 + \alpha T s}{1 + T s} \quad (\alpha > 1)$$

ここで：
- $z = 1/(\alpha T)$: 零点の位置
- $p = 1/T$: 極の位置
- $\alpha = p/z$: 極零点比
- $K_c$: ゲイン調整

### 5.2 位相進み補償器の特性

**最大位相進み角**は周波数 $\omega_m$ で発生します：

$$\omega_m = \frac{1}{T\sqrt{\alpha}} = \sqrt{zp}$$

最大位相進み角 $\phi_m$ は：

$$\sin(\phi_m) = \frac{\alpha - 1}{\alpha + 1}$$

または：

$$\phi_m = \sin^{-1}\left(\frac{\alpha - 1}{\alpha + 1}\right)$$

**例**：$\alpha = 10$ のとき、$\phi_m \approx 55°$

### 5.3 補償器設計手順

**ステップ1**: 要求される位相余裕 $PM_{\text{desired}}$ を決定

例：$PM_{\text{desired}} = 50°$

**ステップ2**: 補償されていない系の現在の位相余裕 $PM_0$ を測定

例：$PM_0 = 20°$

**ステップ3**: 必要な位相進み角を計算

$$\phi_m = (PM_{\text{desired}} - PM_0) + 5° \sim 12°$$

（5°～12°は補償器のゲイン増加による余裕の減少を考慮）

例：$\phi_m = (50° - 20°) + 10° = 40°$

**ステップ4**: $\alpha$ を計算

$$\alpha = \frac{1 + \sin(\phi_m)}{1 - \sin(\phi_m)}$$

例：$\phi_m = 40°$ のとき、$\alpha \approx 3.57$

**ステップ5**: $\omega_m$ を新しいゲイン交差周波数に配置

新しい $\omega_{gc}$ は、補償後のゲインが 0dB となる点に設定します：

$$20\log_{10}|G(j\omega_m)| + 10\log_{10}(\alpha) = 0$$

ここから $\omega_m$ を求めます。

**ステップ6**: $T$ を計算

$$T = \frac{1}{\omega_m \sqrt{\alpha}}$$

**ステップ7**: 補償器を実装

$$G_c(s) = K_c \frac{s + 1/(\alpha T)}{s + 1/T}$$

ゲイン $K_c$ は、望ましい定常特性を得るように調整します。

### 5.4 設計例

**問題**: 開ループ伝達関数 $G(s) = \frac{10}{s(s+1)}$ に対して、位相余裕 $PM = 50°$ を実現する位相進み補償器を設計せよ。

**解**：

**ステップ1**: 現在の位相余裕を評価

中級編の計算から、$PM_0 \approx 18°$ でした。

**ステップ2**: 必要な位相進み角

$$\phi_m = (50° - 18°) + 10° = 42°$$

**ステップ3**: $\alpha$ を計算

$$\sin(42°) \approx 0.669$$

$$\alpha = \frac{1 + 0.669}{1 - 0.669} = \frac{1.669}{0.331} \approx 5.04$$

**ステップ4**: $\omega_m$ を決定

補償器のゲイン増加は $10\log_{10}(5.04) \approx 7$ dB です。

元の系で $|G(j\omega)| = -7$ dB となる周波数を探します：

$$20\log_{10}\left(\frac{10}{\omega\sqrt{1+\omega^2}}\right) = -7$$

$$\frac{10}{\omega\sqrt{1+\omega^2}} = 10^{-7/20} \approx 0.447$$

数値的に解くと、$\omega_m \approx 4.5$ rad/s

**ステップ5**: $T$ を計算

$$T = \frac{1}{\omega_m\sqrt{\alpha}} = \frac{1}{4.5\sqrt{5.04}} \approx 0.099$$

**ステップ6**: 補償器

零点：$z = 1/(\alpha T) = 1/(5.04 \times 0.099) \approx 2.0$

極：$p = 1/T = 1/0.099 \approx 10.1$

$$G_c(s) = \frac{s + 2.0}{s + 10.1}$$

ゲイン調整を含めた最終的な補償器：

$$G_c(s) = K_c \frac{s + 2}{s + 10}$$

ここで、$K_c$ は定常特性を満たすように調整します（通常 $K_c = \alpha = 5$ 程度）。

### 5.5 位相遅れ補償器との比較

参考として、**位相遅れ補償器 (lag compensator)** との違いを示します：

| 特性 | 位相進み (Lead) | 位相遅れ (Lag) |
|------|----------------|---------------|
| 目的 | 位相余裕の改善 | 定常偏差の改善 |
| 零点と極 | $0 < z < p$ | $0 < p < z$ |
| 応答速度 | 速くなる | 遅くなる |
| 使用場面 | 不安定化の防止 | 定常精度の向上 |

---

## 6. ロバスト安定性と不確かさ (Robust Stability and Uncertainty)

### 6.1 モデル不確かさの表現

実際のプラントは、モデル化誤差や時変パラメータを含みます。真のプラント $P(s)$ は：

$$P(s) = G(s)[1 + \Delta(s)]$$

ここで、$G(s)$ は公称モデル、$\Delta(s)$ は**乗法的不確かさ (multiplicative uncertainty)** です。

### 6.2 ロバスト安定条件

閉ループ系がロバスト安定であるためには：

$$|T(j\omega)| |\Delta(j\omega)| < 1 \quad \forall \omega$$

ここで、$T(s) = \frac{L(s)}{1+L(s)}$ は**相補感度関数 (complementary sensitivity function)** です。

実用的には、$|\Delta(j\omega)| \leq \Delta_{\max}$ とすると：

$$\|T\|_{\infty} < \frac{1}{\Delta_{\max}}$$

### 6.3 安定余裕との関係

ゲイン余裕と位相余裕は、ロバスト安定性の十分条件を与えます：

- $GM \geq 2$ ($6$ dB) かつ $PM \geq 30°$ → 少なくとも 50%のゲイン不確かさと 30°の位相不確かさに耐える

より高い安定余裕は、より大きな不確かさに対するロバスト性を保証します。

---

## まとめ

この理解者向け技術ノートでは、以下の高度な内容を学びました：

- **ラウス法の特殊ケース**: εメソッドと補助方程式による第1列のゼロや行全体のゼロの処理
- **ナイキスト判別法の厳密な理論**: $Z = N + P$ の偏角の原理に基づく導出と囲み回数の数え方
- **開ループ不安定系の取り扱い**: $P > 0$ の場合のナイキスト判別法の適用
- **非最小位相系**: 右半平面零点を持つ系の特性と設計上の困難
- **安定余裕と過渡応答の関係**: 位相余裕と減衰係数の関係、ゲイン余裕とロバスト性
- **位相進み補償器の系統的設計**: $\alpha$ の選定、最大位相進み周波数の配置、実際の設計手順
- **ロバスト安定性**: モデル不確かさに対する安定性の保証

これらの知識により、以下が可能になります：
1. 複雑なシステムの安定性を厳密に解析できる
2. 開ループ不安定系や非最小位相系も適切に扱える
3. 十分な安定余裕を持つ制御系を設計できる
4. モデル不確かさに対してロバストな制御系を構築できる

フィードバック制御系の安定性解析と設計は、制御工学の中核をなす技術です。本章で学んだラウス法、ナイキスト法、安定余裕の概念、そして補償器設計手法は、実用的な制御系開発において不可欠なツールとなります。次章では、これらの基礎の上に、より高度な制御系設計手法や最適制御理論へと進んでいきます。
