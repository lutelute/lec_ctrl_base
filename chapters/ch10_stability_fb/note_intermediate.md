# 第10章 FBシステムの安定性 - 中級編

## 1. ラウス法による安定判別 (Routh-Hurwitz Criterion)

### 1.1 特性方程式とラウス配列

初級編では、安定性の基本概念を学びました。中級編では、**ラウス法 (Routh-Hurwitz criterion)** を用いた系統的な安定判別手法を学びます。

閉ループ系の特性方程式が次のように与えられたとします：

$$a_0 s^n + a_1 s^{n-1} + a_2 s^{n-2} + \cdots + a_{n-1} s + a_n = 0$$

**ラウス配列 (Routh array)** は以下のように構成されます：

$$\begin{aligned}
s^n &: \quad a_0 \quad a_2 \quad a_4 \quad \cdots \\
s^{n-1} &: \quad a_1 \quad a_3 \quad a_5 \quad \cdots \\
s^{n-2} &: \quad b_1 \quad b_2 \quad b_3 \quad \cdots \\
s^{n-3} &: \quad c_1 \quad c_2 \quad c_3 \quad \cdots \\
&\vdots \\
s^0 &: \quad h_1
\end{aligned}$$

ここで、各係数は以下の公式で計算されます：

$$b_1 = \frac{a_1 a_2 - a_0 a_3}{a_1}, \quad b_2 = \frac{a_1 a_4 - a_0 a_5}{a_1}$$

$$c_1 = \frac{b_1 a_3 - a_1 b_2}{b_1}, \quad c_2 = \frac{b_1 a_5 - a_1 b_3}{b_1}$$

### 1.2 安定判別の手順

**ラウス・フルヴィッツ安定判別法**：
1. 特性方程式の係数からラウス配列を作成します
2. ラウス配列の**第1列**の符号変化の回数を数えます
3. 符号変化の回数が、**右半平面の極の個数**に等しくなります
4. したがって、**符号変化が0回**であれば、系は安定です

**例題1**: 3次系の安定判別

特性方程式 $s^3 + 6s^2 + 11s + 6 = 0$ の安定性を判別します。

ラウス配列を構成します：

$$\begin{aligned}
s^3 &: \quad 1 \quad 11 \\
s^2 &: \quad 6 \quad 6 \\
s^1 &: \quad \frac{6 \cdot 11 - 1 \cdot 6}{6} = 10 \\
s^0 &: \quad \frac{10 \cdot 6 - 6 \cdot 0}{10} = 6
\end{aligned}$$

第1列は $1, 6, 10, 6$ です。すべて正で符号変化がないため、この系は**安定**です。

### 1.3 限界安定のケース

ラウス配列の第1列に**ゼロ**が現れる場合は、限界安定または不安定を示します。

**例題2**: 限界安定系

特性方程式 $s^3 + 2s^2 + 2s + 4 = 0$ を考えます：

$$\begin{aligned}
s^3 &: \quad 1 \quad 2 \\
s^2 &: \quad 2 \quad 4 \\
s^1 &: \quad \frac{2 \cdot 2 - 1 \cdot 4}{2} = 0 \quad \leftarrow \text{ゼロが出現}
\end{aligned}$$

このケースは**限界安定**または**不安定**を示します。

## 2. ナイキスト安定判別法 (Nyquist Stability Criterion)

### 2.1 ナイキスト線図とは

**ナイキスト線図 (Nyquist diagram)** は、開ループ伝達関数 $G(j\omega)$ を複素平面上にプロットしたものです。

周波数 $\omega$ を $0$ から $\infty$ まで変化させたとき、$G(j\omega)$ の軌跡を描きます：
- 横軸：実部 $\text{Re}[G(j\omega)]$
- 縦軸：虚部 $\text{Im}[G(j\omega)]$

### 2.2 ナイキスト安定判別法の基礎

**単純化されたナイキスト判別法** (開ループ系が安定な場合)：

閉ループ系が安定であるための条件は、ナイキスト線図が点 $(-1, 0)$ を**囲まない**ことです。

**例題3**: 1次遅れ系のナイキスト線図

開ループ伝達関数 $G(s) = \frac{K}{s+1}$ を考えます。

$s = j\omega$ を代入すると：

$$G(j\omega) = \frac{K}{j\omega + 1} = \frac{K(1 - j\omega)}{1 + \omega^2}$$

実部と虚部：

$$\text{Re}[G(j\omega)] = \frac{K}{1 + \omega^2}, \quad \text{Im}[G(j\omega)] = \frac{-K\omega}{1 + \omega^2}$$

- $\omega = 0$：点 $(K, 0)$
- $\omega \to \infty$：点 $(0, 0)$

この軌跡は半円を描き、$K < 1$ であれば $(-1, 0)$ を囲みません。

### 2.3 ナイキスト判別法の実践的な使い方

**手順**：
1. 開ループ伝達関数 $G(j\omega)H(j\omega)$ のナイキスト線図を描く
2. 点 $(-1, 0)$ の位置を確認する
3. 線図が $(-1, 0)$ を囲む回数 $N$ を数える（反時計回りを正）
4. 開ループ不安定極の数を $P$ とする
5. 閉ループ右半平面極の数は $Z = N + P$
6. $Z = 0$ なら閉ループ系は安定

## 3. ゲイン余裕と位相余裕 (Gain Margin and Phase Margin)

### 3.1 ゲイン余裕 (Gain Margin, GM)

**ゲイン余裕 (GM)** は、系を不安定にせずに増加できるゲインの上限を示します。

**定義**：

位相が $-180°$ となる周波数 $\omega_{pc}$（**位相交差周波数, phase crossover frequency**）において：

$$GM = \frac{1}{|G(j\omega_{pc})|} \quad \text{(倍数表示)}$$

$$GM_{dB} = -20\log_{10}|G(j\omega_{pc})| \quad \text{(dB表示)}$$

**物理的意味**：
- $GM = 2$ （6dB）：ゲインを2倍にすると不安定になる
- $GM = 10$ （20dB）：ゲインを10倍にできる余裕がある

### 3.2 位相余裕 (Phase Margin, PM)

**位相余裕 (PM)** は、系を不安定にせずに遅延できる位相の範囲を示します。

**定義**：

ゲインが $1$ (0dB) となる周波数 $\omega_{gc}$（**ゲイン交差周波数, gain crossover frequency**）において：

$$PM = 180° + \angle G(j\omega_{gc})$$

**物理的意味**：
- $PM = 45°$：位相が45度遅れると不安定になる
- $PM = 60°$：十分な安定余裕がある

### 3.3 ボード線図からの余裕の読み取り

**ゲイン余裕の読み取り**：
1. ボード線図の位相特性から、位相が $-180°$ となる周波数 $\omega_{pc}$ を見つける
2. その周波数でのゲイン特性の値を読む
3. $GM_{dB} = 0 - (\text{そのゲイン値})$

**位相余裕の読み取り**：
1. ボード線図のゲイン特性から、ゲインが 0dB となる周波数 $\omega_{gc}$ を見つける
2. その周波数での位相特性の値を読む
3. $PM = 180° + (\text{その位相値})$

### 3.4 実践例：2次系の安定余裕

開ループ伝達関数 $G(s) = \frac{10}{s(s+1)}$ の安定余裕を求めます。

$s = j\omega$ を代入すると：

$$G(j\omega) = \frac{10}{j\omega(j\omega+1)} = \frac{10}{-\omega^2 + j\omega}$$

**ゲイン**：

$$|G(j\omega)| = \frac{10}{\omega\sqrt{1+\omega^2}}$$

**位相**：

$$\angle G(j\omega) = -90° - \tan^{-1}(\omega)$$

**位相余裕の計算**：

$|G(j\omega_{gc})| = 1$ となる周波数を求めます：

$$\frac{10}{\omega_{gc}\sqrt{1+\omega_{gc}^2}} = 1$$

数値的に解くと、$\omega_{gc} \approx 3.0$ rad/s

位相余裕：

$$PM = 180° + (-90° - \tan^{-1}(3.0)) \approx 180° - 90° - 71.6° = 18.4°$$

この系は位相余裕が小さく、**過渡応答にオーバーシュートが生じやすい**ことが予想されます。

## 4. 安定化設計の考え方

### 4.1 設計目標としての安定余裕

制御系設計では、以下の安定余裕を目標とすることが一般的です：

| 指標 | 推奨値 | 意味 |
|------|--------|------|
| ゲイン余裕 | $GM \geq 6$ dB | ゲインを2倍にしても安定 |
| 位相余裕 | $PM \geq 45°$ | 適度な減衰特性 |

### 4.2 位相進み補償による安定化

位相余裕が不足している場合、**位相進み補償器 (lead compensator)** を用いて改善します：

$$G_c(s) = K_c \frac{s + z}{s + p} \quad (z < p)$$

この補償器は、ゲイン交差周波数付近で位相を進ませ、位相余裕を増加させます。

**例**：

先ほどの $G(s) = \frac{10}{s(s+1)}$ に対して、位相進み補償器 $G_c(s) = \frac{s+2}{s+10}$ を追加すると、位相余裕が改善されます。

### 4.3 ゲイン調整による安定化

最も単純な安定化手法は、**ゲインを下げる**ことです：

- ゲイン交差周波数が低くなる
- 位相余裕が増加する
- ただし、応答速度は低下する

**トレードオフ**：
- 高いゲイン：高速応答、定常偏差が小さい ↔ 安定余裕が小さい
- 低いゲイン：安定余裕が大きい ↔ 応答が遅い、定常偏差が大きい

---

## まとめ

この中級編では、以下を学びました：

- **ラウス法**：特性方程式からラウス配列を作成し、第1列の符号変化で安定性を判別
- **ナイキスト線図**：開ループ伝達関数 $G(j\omega)$ を複素平面上にプロットし、$(-1, 0)$ の囲み方で判別
- **ゲイン余裕 (GM)**：位相が $-180°$ となる周波数でのゲインの余裕、推奨値 $\geq 6$ dB
- **位相余裕 (PM)**：ゲインが 0dB となる周波数での位相の余裕、推奨値 $\geq 45°$
- **安定化設計**：補償器やゲイン調整により安定余裕を確保

次の上級編では、ナイキスト判別法の厳密な理論や、より高度な補償器設計手法について学習します。
