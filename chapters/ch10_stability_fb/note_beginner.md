# 第10章 FBシステムの安定性 - 初級編

## 1. 安定性入門 (Introduction to Stability)

### 1.1 安定性とは何か

**安定性 (Stability)** は、制御系が外乱や初期条件の変化に対してどのように振る舞うかを表す最も重要な性質の一つです。システムが安定であるとは、時間が経過するにつれて出力が有界な値に収束することを意味します。

制御システムにおいて、安定性は設計の第一条件です。どれほど高性能な制御系でも、不安定であれば実用に耐えません。

---

## 2. 安定なシステムと不安定なシステム (Stable vs. Unstable Systems)

### 2.1 安定なシステムの特徴

**安定なシステム (Stable System)** では、以下の特徴が見られます：

- **収束性**: 時間とともに出力が一定値に近づく
- **有界性**: 出力が無限大に発散しない
- **減衰振動**: 振動がある場合、振幅が徐々に小さくなる

数学的には、システムの出力 $y(t)$ が次の条件を満たします：

$$\lim_{t \to \infty} y(t) = \text{有限値}$$

**例**:
- 部屋の温度制御システム: 設定温度付近で安定
- 自動車のクルーズコントロール: 目標速度で安定

### 2.2 不安定なシステムの特徴

**不安定なシステム (Unstable System)** では、以下のような振る舞いが見られます：

- **発散**: 時間とともに出力が無限大に増加
- **持続振動**: 振動の振幅が減衰せずに増加
- **制御不能**: 目標値に収束しない

数学的には：

$$\lim_{t \to \infty} |y(t)| = \infty$$

**例**:
- 過度なゲインを持つフィードバック系: 発振や発散
- 不適切に設計されたロボットアームの制御: 暴走

### 2.3 限界安定 (Marginally Stable)

**限界安定 (Marginally Stable)** は、安定と不安定の境界にある状態です：

- 出力が発散はしないが、収束もしない
- 一定振幅の振動が継続する
- 実用上は望ましくない状態

$$\lim_{t \to \infty} |y(t)| = \text{一定値（振動）}$$

---

## 3. 特性方程式と極 (Characteristic Equation and Poles)

### 3.1 特性方程式

フィードバック制御系の安定性は、**特性方程式 (Characteristic Equation)** によって決定されます。

閉ループ伝達関数が次の形で表されるとき：

$$G_{\text{closed}}(s) = \frac{N(s)}{D(s)}$$

特性方程式は分母を零とする方程式です：

$$D(s) = a_0 s^n + a_1 s^{n-1} + \cdots + a_{n-1} s + a_n = 0$$

ここで：
- $s$ は**ラプラス変数 (Laplace variable)**
- $a_0, a_1, \ldots, a_n$ は**係数 (coefficients)**
- $n$ は**システムの次数 (order of the system)**

### 3.2 極と安定性の関係

特性方程式の解を**極 (poles)** と呼びます。極の位置によってシステムの安定性が決まります：

#### 安定条件
**すべての極が複素平面の左半面にある** とき、システムは安定です。

$$\text{Re}(p_i) < 0 \quad \text{for all poles } p_i$$

#### 不安定条件
**少なくとも1つの極が右半面にある** とき、システムは不安定です。

$$\text{Re}(p_i) > 0 \quad \text{for some pole } p_i$$

#### 限界安定条件
**極が虚軸上にある** とき、システムは限界安定です。

$$\text{Re}(p_i) = 0 \quad \text{for some pole } p_i$$

---

## 4. 安定判別の基礎 (Fundamentals of Stability Analysis)

### 4.1 なぜ安定判別が必要か

実際の制御系設計では、次の理由で安定判別が重要です：

1. **安全性**: 不安定なシステムは危険を伴う可能性がある
2. **性能保証**: 安定性は性能の前提条件
3. **設計指針**: 安定条件からパラメータの範囲を決定できる

### 4.2 安定判別の方法

システムの安定性を判別する主な方法には以下があります：

#### (1) 直接法：極の計算
特性方程式を解いて極を直接求め、その位置を確認する方法です。

**利点**:
- 直感的で分かりやすい
- 極の正確な値が分かる

**欠点**:
- 高次の方程式では計算が困難
- 数値計算の誤差が生じる

#### (2) ラウス法 (Routh-Hurwitz Criterion)
極を直接計算せずに、係数から安定性を判別する方法です。

**利点**:
- 高次システムにも適用可能
- 計算が比較的簡単

**特徴**:
- 特性方程式の係数のみを使用
- ラウス配列を構成して判別

#### (3) ナイキスト法 (Nyquist Criterion)
周波数応答から安定性を判別する方法です。

**利点**:
- 実験データから判別可能
- 安定余裕も評価できる

---

## 5. ラウス法の基本概念 (Basic Concept of Routh Criterion)

### 5.1 ラウス配列とは

**ラウス配列 (Routh Array)** は、特性方程式の係数を特定の規則で並べた表です。

特性方程式が次の形のとき：

$$a_0 s^4 + a_1 s^3 + a_2 s^2 + a_3 s + a_4 = 0$$

ラウス配列は次のように構成されます：

$$\begin{aligned}
s^4: & \quad a_0 \quad a_2 \quad a_4 \\
s^3: & \quad a_1 \quad a_3 \quad 0 \\
s^2: & \quad b_1 \quad b_2 \quad 0 \\
s^1: & \quad c_1 \quad 0 \quad 0 \\
s^0: & \quad d_1 \quad 0 \quad 0
\end{aligned}$$

ここで、$b_1, b_2, c_1, d_1$ は次の式で計算されます：

$$b_1 = \frac{a_1 a_2 - a_0 a_3}{a_1}$$

$$b_2 = \frac{a_1 a_4 - a_0 \cdot 0}{a_1}$$

### 5.2 安定判別の規則

**ラウスの安定判別法**:

システムが安定である ⟺ **ラウス配列の第1列の符号が全て同じ**

言い換えると：
- **符号変化の回数 = 右半平面の極の個数**
- 符号変化が0回 → すべての極が左半平面 → 安定

**例**: 第1列が $(+, +, +, +, +)$ → 安定

**例**: 第1列が $(+, +, -, +, +)$ → 2回の符号変化 → 不安定（右半平面に2つの極）

---

## 6. 安定性の実例 (Examples of Stability Analysis)

### 6.1 例題1：1次システム

特性方程式が次の場合：

$$s + 5 = 0$$

**解析**:
- 極は $s = -5$
- 実部が負 → **安定**

時間応答は指数減衰します：

$$y(t) = y_0 e^{-5t}$$

### 6.2 例題2：2次システム

特性方程式：

$$s^2 + 4s + 3 = 0$$

**因数分解**:
$$（s + 1)(s + 3) = 0$$

極は $s = -1, -3$ → 両方とも左半平面 → **安定**

ラウス配列：
$$\begin{aligned}
s^2: & \quad 1 \quad 3 \\
s^1: & \quad 4 \quad 0 \\
s^0: & \quad 3 \quad 0
\end{aligned}$$

第1列：$(1, 4, 3)$ → すべて正 → 符号変化なし → **安定**

### 6.3 例題3：不安定なシステム

特性方程式：

$$s^2 - 2s + 1 = 0$$

**因数分解**:
$$(s - 1)^2 = 0$$

極は $s = 1$ (重根) → 右半平面 → **不安定**

ラウス配列：
$$\begin{aligned}
s^2: & \quad 1 \quad 1 \\
s^1: & \quad -2 \quad 0 \\
s^0: & \quad 1 \quad 0
\end{aligned}$$

第1列：$(1, -2, 1)$ → 符号変化2回 → **不安定**

---

## 7. フィードバックゲインと安定性 (Feedback Gain and Stability)

### 7.1 ゲインの影響

フィードバック系において、**ゲイン (gain)** $K$ の大きさは安定性に大きな影響を与えます。

フィードバック系の特性方程式が次の形の場合：

$$D(s) + K N(s) = 0$$

ゲイン $K$ が変化すると極の位置が変わり、安定性が変化します。

### 7.2 安定限界ゲイン

**安定限界ゲイン (critical gain)** $K_{\text{cr}}$ は、システムが限界安定となるゲインの値です。

- $K < K_{\text{cr}}$: 安定
- $K = K_{\text{cr}}$: 限界安定（持続振動）
- $K > K_{\text{cr}}$: 不安定（発散振動）

実用上は、十分な安定余裕を確保するため：

$$K_{\text{design}} = \frac{K_{\text{cr}}}{2} \sim \frac{K_{\text{cr}}}{3}$$

程度に設定することが推奨されます。

---

## 8. 安定余裕の概念 (Concept of Stability Margins)

### 8.1 なぜ余裕が必要か

実際の制御系では、モデル化誤差、パラメータ変動、外乱などにより、理論値からのずれが生じます。そのため、単に「安定」であるだけでなく、**十分な安定余裕 (stability margin)** を持つことが重要です。

### 8.2 安定余裕の種類

#### ゲイン余裕 (Gain Margin, GM)
システムのゲインが **どれだけ増加しても安定性を保てるか** を示す指標です。

- 単位：dB (デシベル)
- 望ましい値：$\text{GM} \geq 6 \, \text{dB}$ (約2倍の余裕)

#### 位相余裕 (Phase Margin, PM)
システムの位相遅れが **どれだけ増加しても安定性を保てるか** を示す指標です。

- 単位：度 (degree)
- 望ましい値：$\text{PM} \geq 45°$ ～ $60°$

これらの概念は、次章以降でより詳しく学習します。

---

## まとめ

この初級編では、以下を学びました：

- **安定性の定義**: 時間経過に伴う出力の収束性
- **安定・不安定・限界安定**: システムの3つの状態
- **特性方程式と極**: 極の位置が安定性を決定する
- **極の位置と安定性**: 左半平面→安定、右半平面→不安定
- **ラウス法の基本**: 係数から安定性を判別する方法
- **ラウス配列**: 第1列の符号変化で極の位置を判定
- **ゲインと安定性**: フィードバックゲインが安定性に影響
- **安定余裕の重要性**: 実用上は余裕を持った設計が必要

次のステップでは、ラウス法の詳細な適用方法、ナイキスト判別法、そして安定余裕の計算方法を学んでいきます。安定性解析は制御工学の基礎であり、すべての制御系設計の出発点となります。
