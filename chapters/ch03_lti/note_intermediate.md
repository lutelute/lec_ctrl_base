# 第3章 LTIシステムの表現 - 中級編

## 1. LTIシステムの数学的表現 (Mathematical Representation of LTI Systems)

### 1.1 時間領域と周波数領域

初級編では、LTIシステムの基本的な性質である線形性と時不変性について学びました。中級編では、これらの性質を活用して、システムの入出力関係を数学的に表現する方法を学びます。

LTIシステムは、主に以下の2つの数学的表現で記述できます：

1. **時間領域**: 畳み込み積分 (Convolution Integral)
2. **周波数領域**: 伝達関数 (Transfer Function)

これらの表現は、第2章で学んだ**ラプラス変換**によって相互に変換できます。

### 1.2 インパルス応答によるシステムの完全な記述

LTIシステムの重要な性質は、**インパルス応答 $h(t)$ だけで、システムの挙動が完全に決まる**ことです。

任意の入力信号 $x(t)$ は、無数のインパルス信号の重ね合わせとして表現できます：

$$x(t) = \int_{-\infty}^{\infty} x(\tau)\delta(t - \tau)d\tau$$

これを**サンプリング性 (sifting property)** と呼びます。ここで、$\delta(t - \tau)$ は時刻 $\tau$ に位置するインパルスです。

線形性と時不変性を使うと、出力 $y(t)$ は次のように表現できます：

$$y(t) = \int_{-\infty}^{\infty} x(\tau)h(t - \tau)d\tau$$

これが**畳み込み積分**です！

---

## 2. 畳み込み積分 (Convolution Integral)

### 2.1 畳み込み積分の定義

**畳み込み積分 (convolution integral)** は、LTIシステムの入力 $x(t)$ と出力 $y(t)$ の関係を表す基本的な式です：

$$y(t) = \int_{-\infty}^{\infty} h(\tau)x(t - \tau)d\tau = h(t) * x(t)$$

または、変数を入れ替えた形式でも表現できます：

$$y(t) = \int_{-\infty}^{\infty} x(\tau)h(t - \tau)d\tau = x(t) * h(t)$$

ここで：
- $h(t)$ は**インパルス応答**（システムの特性）
- $x(t)$ は**入力信号**
- $y(t)$ は**出力信号**
- $*$ は**畳み込み演算子**
- $\tau$ は**積分変数**（ダミー変数）

### 2.2 畳み込み積分の計算手順

畳み込み積分 $y(t) = h(t) * x(t)$ を計算する一般的な手順は以下の通りです：

**ステップ1**: $h(\tau)$ と $x(\tau)$ をそれぞれ $\tau$ の関数として描く

**ステップ2**: どちらか一方（通常は $x(\tau)$）を時間反転して $x(-\tau)$ を得る

**ステップ3**: 反転した信号を時刻 $t$ だけシフトして $x(t - \tau)$ を得る

**ステップ4**: $h(\tau)$ と $x(t - \tau)$ の積を計算

**ステップ5**: 積分範囲全体で面積を計算（これが $y(t)$ の値）

**ステップ6**: 様々な $t$ の値について繰り返す

### 2.3 畳み込み積分の例題1：指数関数

**問題**: 以下のシステムと入力に対する出力を求めよ。

- インパルス応答: $h(t) = e^{-t}u(t)$
- 入力信号: $x(t) = u(t)$ （単位ステップ関数）

ここで、$u(t)$ は単位ステップ関数（$t \geq 0$ で1、$t < 0$ で0）です。

**解答**:

畳み込み積分を計算します：

$$y(t) = \int_{-\infty}^{\infty} h(\tau)x(t - \tau)d\tau$$

因果的システムなので、$h(\tau) = 0$ for $\tau < 0$ および $x(t - \tau) = 0$ for $t - \tau < 0$（つまり $\tau > t$）です。

したがって、積分範囲は $0 \leq \tau \leq t$ となります（$t > 0$ の場合）：

$$y(t) = \int_0^t e^{-\tau} \cdot 1 \, d\tau = \left[-e^{-\tau}\right]_0^t = -e^{-t} + 1 = 1 - e^{-t}$$

**結果**: $y(t) = (1 - e^{-t})u(t)$

これは、RC回路の単位ステップ応答に相当し、時定数1で1に近づく応答を表します。

### 2.4 畳み込み積分の例題2：矩形パルス

**問題**: 以下の信号の畳み込みを求めよ。

- $h(t) = u(t) - u(t - 2)$ （幅2の矩形パルス）
- $x(t) = u(t) - u(t - 1)$ （幅1の矩形パルス）

**解答**:

これは区分的に計算する必要があります。矩形パルス同士の畳み込みは、台形状の信号になります。

**$0 \leq t < 1$ の範囲**:
$$y(t) = \int_0^t 1 \cdot 1 \, d\tau = t$$

**$1 \leq t < 2$ の範囲**:
$$y(t) = \int_{t-1}^t 1 \cdot 1 \, d\tau = 1$$

**$2 \leq t < 3$ の範囲**:
$$y(t) = \int_{t-1}^2 1 \cdot 1 \, d\tau = 3 - t$$

**$t \geq 3$ の範囲**:
$$y(t) = 0$$

**結果**:
$$y(t) = \begin{cases}
t & 0 \leq t < 1 \\
1 & 1 \leq t < 2 \\
3 - t & 2 \leq t < 3 \\
0 & \text{otherwise}
\end{cases}$$

これは台形状の信号で、最大値1を幅1の区間で保持します。

### 2.5 畳み込みの性質

畳み込み演算は、以下の重要な性質を持ちます：

**1. 交換法則 (Commutativity)**:
$$h(t) * x(t) = x(t) * h(t)$$

**2. 結合法則 (Associativity)**:
$$[h_1(t) * h_2(t)] * x(t) = h_1(t) * [h_2(t) * x(t)]$$

**3. 分配法則 (Distributivity)**:
$$h(t) * [x_1(t) + x_2(t)] = h(t) * x_1(t) + h(t) * x_2(t)$$

**4. 単位元 (Identity)**:
$$h(t) * \delta(t) = h(t)$$

これらの性質により、複雑なシステムを簡単なサブシステムの組み合わせとして解析できます。

---

## 3. 微分方程式によるシステム記述 (System Description by Differential Equations)

### 3.1 微分方程式の一般形

多くの物理システムは、**線形常微分方程式 (linear ordinary differential equation)** で記述できます：

$$a_n\frac{d^ny(t)}{dt^n} + a_{n-1}\frac{d^{n-1}y(t)}{dt^{n-1}} + \cdots + a_1\frac{dy(t)}{dt} + a_0y(t) = b_m\frac{d^mx(t)}{dt^m} + b_{m-1}\frac{d^{m-1}x(t)}{dt^{m-1}} + \cdots + b_1\frac{dx(t)}{dt} + b_0x(t)$$

ここで：
- $y(t)$ は**出力**
- $x(t)$ は**入力**
- $a_i, b_j$ は**定数係数**（システムのパラメータ）
- $n$ は**システムの次数**
- 通常、$n \geq m$ （物理的実現可能性のため）

### 3.2 具体例：RC回路

**RC回路**の電圧-電流関係は、キルヒホッフの法則から導かれます。

回路方程式：
$$v_{in}(t) = Ri(t) + v_C(t)$$

コンデンサの電圧-電流関係：
$$i(t) = C\frac{dv_C(t)}{dt}$$

これらを組み合わせると：
$$v_{in}(t) = RC\frac{dv_C(t)}{dt} + v_C(t)$$

出力を $y(t) = v_C(t)$、入力を $x(t) = v_{in}(t)$ とすると：

$$RC\frac{dy(t)}{dt} + y(t) = x(t)$$

または、時定数 $\tau = RC$ を使って：

$$\tau\frac{dy(t)}{dt} + y(t) = x(t)$$

これは**1次遅れ系 (first-order lag system)** の微分方程式です。

### 3.3 具体例：質量-ばね-ダンパ系

**質量-ばね-ダンパ系**は、ニュートンの運動方程式から導かれます。

運動方程式：
$$m\frac{d^2x(t)}{dt^2} + c\frac{dx(t)}{dt} + kx(t) = f(t)$$

ここで：
- $m$ は**質量 (mass)**
- $c$ は**減衰係数 (damping coefficient)**
- $k$ は**ばね定数 (spring constant)**
- $f(t)$ は**外力 (external force)**
- $x(t)$ は**変位 (displacement)**

これは**2次系 (second-order system)** の微分方程式です。

標準形で表すと：

$$\frac{d^2x(t)}{dt^2} + 2\zeta\omega_n\frac{dx(t)}{dt} + \omega_n^2x(t) = \frac{1}{m}f(t)$$

ここで：
- $\omega_n = \sqrt{k/m}$ は**固有角周波数 (natural frequency)**
- $\zeta = \frac{c}{2\sqrt{mk}}$ は**減衰比 (damping ratio)**

減衰比 $\zeta$ の値によって、システムの応答特性が変わります：
- $\zeta < 1$: **不足減衰 (underdamped)** - 振動しながら収束
- $\zeta = 1$: **臨界減衰 (critically damped)** - 最速で振動なく収束
- $\zeta > 1$: **過減衰 (overdamped)** - 振動せず緩やかに収束

---

## 4. 伝達関数との関係 (Relationship with Transfer Function)

### 4.1 微分方程式からの伝達関数導出

第2章で学んだラプラス変換を使うと、微分方程式を代数方程式に変換できます。

**ラプラス変換の微分則**:
$$\mathcal{L}\left\{\frac{d^ny(t)}{dt^n}\right\} = s^nY(s) - s^{n-1}y(0) - s^{n-2}y'(0) - \cdots - y^{(n-1)}(0)$$

初期条件がすべて0の場合（$y(0) = y'(0) = \cdots = 0$）、微分方程式：

$$a_n\frac{d^ny}{dt^n} + a_{n-1}\frac{d^{n-1}y}{dt^{n-1}} + \cdots + a_1\frac{dy}{dt} + a_0y = b_m\frac{d^mx}{dt^m} + \cdots + b_1\frac{dx}{dt} + b_0x$$

のラプラス変換は：

$$(a_ns^n + a_{n-1}s^{n-1} + \cdots + a_1s + a_0)Y(s) = (b_ms^m + b_{m-1}s^{m-1} + \cdots + b_1s + b_0)X(s)$$

**伝達関数 (transfer function)** $H(s)$ は、入出力のラプラス変換の比として定義されます：

$$H(s) = \frac{Y(s)}{X(s)} = \frac{b_ms^m + b_{m-1}s^{m-1} + \cdots + b_1s + b_0}{a_ns^n + a_{n-1}s^{n-1} + \cdots + a_1s + a_0}$$

これは**有理関数 (rational function)** の形をしています。

### 4.2 例：RC回路の伝達関数

RC回路の微分方程式：
$$\tau\frac{dy(t)}{dt} + y(t) = x(t)$$

のラプラス変換（初期条件0）：
$$\tau sY(s) + Y(s) = X(s)$$

伝達関数：
$$H(s) = \frac{Y(s)}{X(s)} = \frac{1}{\tau s + 1} = \frac{1/\tau}{s + 1/\tau}$$

**極 (pole)**: $s = -1/\tau$（実数、負）

極が負の実数なので、このシステムは**安定 (stable)** です。

### 4.3 例：2次系の伝達関数

質量-ばね-ダンパ系の微分方程式：
$$\frac{d^2x}{dt^2} + 2\zeta\omega_n\frac{dx}{dt} + \omega_n^2x = \frac{1}{m}f(t)$$

のラプラス変換：
$$s^2X(s) + 2\zeta\omega_nsX(s) + \omega_n^2X(s) = \frac{1}{m}F(s)$$

伝達関数：
$$H(s) = \frac{X(s)}{F(s)} = \frac{1/m}{s^2 + 2\zeta\omega_ns + \omega_n^2}$$

**極**: $s = -\zeta\omega_n \pm j\omega_n\sqrt{1 - \zeta^2}$ （$0 < \zeta < 1$ の場合）

極が複素共役で実部が負なので、このシステムも**安定**です。

### 4.4 インパルス応答との関係

伝達関数 $H(s)$ は、インパルス応答 $h(t)$ のラプラス変換です：

$$H(s) = \mathcal{L}\{h(t)\} = \int_0^\infty h(t)e^{-st}dt$$

逆に、インパルス応答は伝達関数の逆ラプラス変換で求められます：

$$h(t) = \mathcal{L}^{-1}\{H(s)\}$$

**例**: RC回路の場合、$H(s) = \frac{1/\tau}{s + 1/\tau}$ なので、

$$h(t) = \mathcal{L}^{-1}\left\{\frac{1/\tau}{s + 1/\tau}\right\} = \frac{1}{\tau}e^{-t/\tau}u(t)$$

これが、RC回路のインパルス応答です。

---

## 5. 第2章ラプラス変換との接続 (Connection with Laplace Transform)

### 5.1 ラプラス変換の威力

第2章で学んだラプラス変換は、LTIシステムの解析に極めて強力なツールです。その理由は：

1. **微分方程式が代数方程式になる**: 時間領域の複雑な微分方程式が、$s$領域では簡単な代数式になる

2. **畳み込みが掛け算になる**: 時間領域の畳み込み積分 $y(t) = h(t) * x(t)$ が、$s$領域では単純な掛け算 $Y(s) = H(s)X(s)$ になる

3. **極と零点による解析**: 伝達関数の極と零点から、システムの安定性や応答特性が分かる

### 5.2 時間領域と周波数領域の対応

以下の表は、時間領域と周波数領域（$s$領域）の対応関係をまとめたものです：

| 時間領域 | $s$領域 |
|---------|---------|
| $h(t)$ | $H(s) = \mathcal{L}\{h(t)\}$ |
| $x(t)$ | $X(s) = \mathcal{L}\{x(t)\}$ |
| $y(t)$ | $Y(s) = \mathcal{L}\{y(t)\}$ |
| $y(t) = h(t) * x(t)$ | $Y(s) = H(s)X(s)$ |
| $\frac{d^ny(t)}{dt^n}$ | $s^nY(s)$ （初期条件0） |
| $\delta(t)$ | $1$ |
| $u(t)$ | $\frac{1}{s}$ |
| $e^{-at}u(t)$ | $\frac{1}{s + a}$ |

この対応により、複雑な時間領域の計算を、$s$領域で簡単に行うことができます。

### 5.3 システム解析の手順

ラプラス変換を使ったLTIシステム解析の典型的な手順は：

**ステップ1**: 物理システムから微分方程式を導出

**ステップ2**: 微分方程式をラプラス変換して代数方程式を得る

**ステップ3**: 伝達関数 $H(s)$ を求める

**ステップ4**: 極と零点を求め、安定性を判定

**ステップ5**: 入力 $x(t)$ をラプラス変換して $X(s)$ を得る

**ステップ6**: 出力を計算：$Y(s) = H(s)X(s)$

**ステップ7**: 逆ラプラス変換して時間領域の出力 $y(t)$ を得る

この手順により、複雑な物理システムの応答を系統的に解析できます。

### 5.4 部分分数展開の活用

複雑な伝達関数は、**部分分数展開 (partial fraction expansion)** によって簡単な項の和に分解できます。

**例**:
$$H(s) = \frac{s + 3}{s^2 + 3s + 2} = \frac{s + 3}{(s + 1)(s + 2)}$$

を部分分数展開すると：

$$H(s) = \frac{2}{s + 1} - \frac{1}{s + 2}$$

逆ラプラス変換：

$$h(t) = 2e^{-t}u(t) - e^{-2t}u(t) = (2e^{-t} - e^{-2t})u(t)$$

このように、部分分数展開を使えば、複雑な伝達関数の逆ラプラス変換も容易に求められます。

---

## まとめ

この中級編では、以下を学びました：

- **畳み込み積分**：$y(t) = \int_{-\infty}^{\infty} h(\tau)x(t - \tau)d\tau = h(t) * x(t)$
  - LTIシステムの時間領域での入出力関係を表す基本式
  - インパルス応答 $h(t)$ が分かれば、任意の入力に対する出力を計算できる

- **微分方程式によるシステム記述**：
  - 多くの物理システムは線形常微分方程式で記述できる
  - RC回路（1次系）、質量-ばね-ダンパ系（2次系）などの具体例

- **伝達関数**：$H(s) = \frac{Y(s)}{X(s)}$
  - 微分方程式をラプラス変換すると伝達関数が得られる
  - 伝達関数はインパルス応答のラプラス変換：$H(s) = \mathcal{L}\{h(t)\}$

- **ラプラス変換の威力**：
  - 時間領域の畳み込みが$s$領域では掛け算になる：$Y(s) = H(s)X(s)$
  - 微分方程式が代数方程式になり、解析が容易になる

- **極と安定性**：
  - 伝達関数の極の位置によって、システムの安定性が決まる
  - 極がすべて左半平面にあれば安定

次の理解者向け編では、因果性とBIBO安定性の詳細、周波数応答、そして状態空間表現への発展について学習します。
